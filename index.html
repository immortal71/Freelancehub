<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freelancer Client Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="font-inter" style="background: #F9FAFB;">
    <!-- Mobile Menu Overlay -->
    <div id="mobile-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden lg:hidden"></div>
    


    <!-- Enhanced Sidebar -->
    <div id="sidebar" class="fixed left-0 top-0 w-64 h-full glass-morphism z-40 sidebar-transition transform -translate-x-full lg:translate-x-0">
        <div class="p-6 border-b border-white/20">
            <div class="flex items-center space-x-3">
                <div class="logo-container gradient-bg rounded-xl flex items-center justify-center">
                    <i class="fas fa-laptop-code text-white text-xl"></i>
                </div>
                <div>
                    <h2 class="text-xl font-bold glow-text">FreelanceHub</h2>
                    <p class="text-sm text-gray-300">Client Portal ✨</p>
                </div>
            </div>
        </div>
        
        <nav class="mt-6" role="navigation" aria-label="Main navigation">
            <a href="#" onclick="showSection('dashboard', this); return false;" class="nav-item nav-item-enhanced active flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem" aria-current="page">
                <i class="fas fa-chart-line mr-3 bounce-enhanced" aria-hidden="true"></i>
                <span class="text-enhanced">Dashboard</span>
            </a>
            <a href="#" onclick="showSection('projects', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-project-diagram mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Projects</span>
            </a>
            <a href="#" onclick="showSection('messages', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-comments mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Messages</span>
                <span class="ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full pulse-enhanced" aria-label="3 unread messages">3</span>
            </a>
            <a href="#" onclick="showSection('invoices', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-file-invoice-dollar mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Invoices</span>
            </a>
            <a href="#" onclick="showSection('files', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-folder mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Files</span>
            </a>
            <a href="#" onclick="showSection('time-tracking', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-clock mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Time Tracking</span>
            </a>
            <a href="#" onclick="showSection('calendar', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-calendar-alt mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Calendar</span>
            </a>
            <a href="#" onclick="showSection('proposals', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-file-contract mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Proposals</span>
            </a>
            <a href="#" onclick="showSection('contracts', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-file-signature mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Contracts</span>
            </a>
            <a href="#" onclick="showSection('settings', this); return false;" class="nav-item nav-item-enhanced flex items-center px-6 py-3 transition-colors duration-200 focus-ring" 
               role="menuitem">
                <i class="fas fa-cog mr-3" aria-hidden="true"></i>
                <span class="text-enhanced">Settings</span>
            </a>
        </nav>
    </div>
    
    <!-- Main Content -->
    <div id="main-content" class="transition-all duration-300 lg:ml-64">
        <!-- Top Header -->
        <header class="header-gradient px-6 py-4 relative overflow-hidden">
            <div class="flex items-center justify-between relative z-10">
                <div class="flex items-center">
                    <!-- Sidebar Toggle Button -->
                    <button id="sidebar-toggle" class="mr-4 p-2 rounded-lg bg-white/20 hover:bg-white/30 transition-all duration-300 relative group">
                        <i class="fas fa-bars text-white group-hover:text-white"></i>
                        <div class="absolute left-0 top-12 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap">
                            Toggle Sidebar
                            <div class="absolute left-4 -top-1 w-2 h-2 bg-gray-800 rotate-45"></div>
                        </div>
                    </button>
                    
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <img id="user-avatar" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                 alt="User Avatar" class="w-12 h-12 rounded-full border-3 border-white shadow-lg cursor-pointer hover:scale-110 transition-transform duration-300">
                            <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white animate-pulse"></div>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold text-white">
                                Welcome back, John! 
                                <span class="inline-block animate-bounce-gentle">👋</span>
                            </h1>
                            <p class="text-white/80 flex items-center">
                                <i class="fas fa-calendar-day mr-2 text-white/90"></i>
                                Here's what's happening today
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <!-- Enhanced Quick Search -->
                    <div class="hidden lg:flex relative">
                        <input type="text" placeholder="Quick search..." 
                               class="search-enhanced-header w-64 pl-10 pr-4 py-2 rounded-full focus:ring-2 focus:ring-white/50 focus:outline-none"
                               aria-label="Search dashboard">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-600"></i>
                    </div>
                    
                    <!-- Help/FAQ -->
                    <div class="relative">
                        <button onclick="toggleHelpDropdown(event)" id="help-btn" class="btn-enhanced p-3 rounded-lg bg-white/20 hover:bg-white/30 focus-ring" 
                                aria-label="Help and Support">
                            <i class="fas fa-question-circle text-white hover:text-white text-lg"></i>
                        </button>
                        
                        <!-- Help Dropdown -->
                        <div id="help-dropdown" class="hidden fixed bg-white rounded-xl shadow-2xl border border-gray-200" style="z-index: 10000; top: 70px; right: 20px; width: 16rem;">
                            <div class="p-4">
                                <h3 class="text-lg font-semibold text-gray-900 mb-3">Help & Support</h3>
                                <div class="space-y-2">
                                    <a href="#" onclick="event.preventDefault()" class="block px-3 py-2 hover:bg-gray-50 rounded-lg text-sm text-gray-700 transition-colors">
                                        <i class="fas fa-book mr-2 text-blue-600"></i>Documentation
                                    </a>
                                    <a href="#" onclick="event.preventDefault()" class="block px-3 py-2 hover:bg-gray-50 rounded-lg text-sm text-gray-700 transition-colors">
                                        <i class="fas fa-video mr-2 text-red-600"></i>Video Tutorials
                                    </a>
                                    <a href="#" onclick="event.preventDefault()" class="block px-3 py-2 hover:bg-gray-50 rounded-lg text-sm text-gray-700 transition-colors">
                                        <i class="fas fa-comments mr-2 text-green-600"></i>Contact Support
                                    </a>
                                    <a href="#" onclick="event.preventDefault()" class="block px-3 py-2 hover:bg-gray-50 rounded-lg text-sm text-gray-700 transition-colors">
                                        <i class="fas fa-keyboard mr-2 text-purple-600"></i>Keyboard Shortcuts
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Theme Toggle -->
                    <button id="theme-toggle" class="btn-enhanced p-3 rounded-lg bg-white/20 hover:bg-white/30 focus-ring" 
                            aria-label="Toggle dark mode">
                        <i class="fas fa-moon text-white hover:text-white text-lg"></i>
                        <div class="tooltip">Toggle Dark Mode</div>
                    </button>
                    
                    <!-- Enhanced Notifications -->
                    <div class="relative">
                        <button id="notifications-btn" class="btn-enhanced p-3 rounded-lg bg-white/20 hover:bg-white/30 focus-ring" 
                                aria-label="View notifications">
                            <i class="fas fa-bell text-white hover:text-white text-lg hover:animate-pulse"></i>
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center animate-pulse">7</span>
                        </button>
                        
                        <!-- Notification Dropdown -->
                        <div id="notifications-dropdown" class="hidden absolute right-0 top-12 w-80 bg-white rounded-xl shadow-2xl border border-gray-200" style="z-index: 9999;">
                            <div class="p-4 border-b border-gray-200">
                                <h3 class="text-lg font-semibold text-gray-900">Notifications</h3>
                            </div>
                            <div class="max-h-64 overflow-y-auto">
                                <div class="p-4 hover:bg-gray-50 cursor-pointer border-b border-gray-100">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mt-2"></div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">New message from Sarah</p>
                                            <p class="text-xs text-gray-500">2 minutes ago</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4 hover:bg-gray-50 cursor-pointer border-b border-gray-100">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">Invoice #1234 paid</p>
                                            <p class="text-xs text-gray-500">1 hour ago</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">Project milestone completed</p>
                                            <p class="text-xs text-gray-500">3 hours ago</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profile Menu -->
                    <div class="flex items-center space-x-3 relative group">
                        <div class="hidden md:block text-right">
                            <p class="text-sm font-medium text-gray-900">John Doe</p>
                            <p class="text-xs text-gray-500">Freelance Developer</p>
                        </div>
                        <button class="w-10 h-10 rounded-full overflow-hidden hover:ring-4 hover:ring-blue-200 transition-all duration-300">
                            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                 alt="Profile" class="w-full h-full object-cover">
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Decorative background elements -->
            <div class="absolute -top-4 -right-4 w-32 h-32 bg-white/10 rounded-full opacity-30"></div>
            <div class="absolute -bottom-2 -left-2 w-20 h-20 bg-white/10 rounded-full opacity-20"></div>
            </div>
        </header>
        
        <!-- Page Content -->
        <main class="p-6">
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="section">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="stats-card-professional floating-card cursor-pointer group" onclick="showSection('projects')">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="stats-title">Active Projects</p>
                                <p class="stats-value counter" data-target="12">0</p>
                                <p class="stats-change">
                                    <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                    +2 this month
                                </p>
                            </div>
                            <div class="stats-icon group-hover:scale-110 transition-all duration-300">
                                <i class="fas fa-project-diagram text-xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-card-professional floating-card cursor-pointer group" style="animation-delay: 0.1s" onclick="showSection('invoices')">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="stats-title">Monthly Revenue</p>
                                <p class="stats-value counter" data-target="12450" data-prefix="$">$0</p>
                                <p class="stats-change">
                                    <i class="fas fa-trending-up text-green-500 mr-1 animate-pulse"></i>
                                    +15% from last month
                                </p>
                            </div>
                            <div class="stats-icon stats-icon-green group-hover:scale-110 transition-all duration-300">
                                <i class="fas fa-dollar-sign text-xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-card-professional floating-card cursor-pointer group" style="animation-delay: 0.2s" onclick="showSection('messages')">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="stats-title">Unread Messages</p>
                                <p class="stats-value counter" data-target="7">0</p>
                                <p class="stats-change">
                                    <i class="fas fa-exclamation-circle text-red-500 mr-1 animate-pulse"></i>
                                    3 urgent
                                </p>
                            </div>
                            <div class="stats-icon stats-icon-purple group-hover:scale-110 transition-all duration-300 relative">
                                <i class="fas fa-envelope text-xl"></i>
                                <div class="absolute -top-2 -right-2 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-xs animate-bounce">3</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-card-professional floating-card cursor-pointer group" style="animation-delay: 0.3s" onclick="showSection('invoices')">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="stats-title">Pending Invoices</p>
                                <p class="stats-value counter" data-target="8750" data-prefix="$">$0</p>
                                <p class="stats-change">
                                    <i class="fas fa-clock text-orange-500 mr-1 animate-spin"></i>
                                    5 invoices
                                </p>
                            </div>
                            <div class="stats-icon stats-icon-orange group-hover:scale-110 transition-all duration-300">
                                <i class="fas fa-file-invoice text-xl"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Charts and Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Interactive Charts -->
                    <div class="lg:col-span-2 professional-card">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Revenue & Project Analytics</h3>
                        
                        <!-- Chart Container -->
                        <div class="relative h-64 mb-6">
                            <canvas id="revenueChart" class="w-full h-full"></canvas>
                        </div>
                        
                        <!-- Project Progress Bars -->
                        <div class="space-y-6">
                            <div class="progress-section">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="project-name">E-commerce Website</span>
                                    <span class="progress-percentage">85%</span>
                                </div>
                                <div class="progress-track">
                                    <div class="progress-fill" style="width: 85%;"></div>
                                </div>
                            </div>
                            
                            <div class="progress-section">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="project-name">Mobile App UI</span>
                                    <span class="progress-percentage">60%</span>
                                </div>
                                <div class="progress-track">
                                    <div class="progress-fill" style="width: 60%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="professional-card">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h3>
                        <div class="space-y-4">
                            <div class="flex items-start space-x-3">
                                <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-sm text-gray-900">New message from Sarah</p>
                                    <p class="text-xs text-gray-500">2 minutes ago</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-sm text-gray-900">Invoice #1234 paid</p>
                                    <p class="text-xs text-gray-500">1 hour ago</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <div class="w-2 h-2 bg-purple-500 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-sm text-gray-900">Project milestone completed</p>
                                    <p class="text-xs text-gray-500">3 hours ago</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Projects Section -->
            <div id="projects-section" class="section hidden">
                <div class="mb-6">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4">
                        <h2 class="text-2xl font-bold text-gray-900 mb-4 sm:mb-0">Projects</h2>
                        <button class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 btn-ripple btn-burst">
                            <i class="fas fa-plus mr-2"></i>New Project
                        </button>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <div class="flex-1">
                            <input type="text" placeholder="Search projects..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300">
                        </div>
                        <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300">
                            <option>All Status</option>
                            <option>Active</option>
                            <option>Completed</option>
                            <option>On Hold</option>
                        </select>
                        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-300 btn-spinner">
                            <i class="fas fa-filter mr-2"></i>Filter
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="professional-card card-hover">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">E-commerce Website</h3>
                            <span class="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full">Active</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">Complete redesign of the online store with modern UI/UX</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>Due: Dec 15, 2024</span>
                            <span>$5,500</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                            <div class="bg-blue-600 h-2 rounded-full" style="width: 85%"></div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">85% Complete</span>
                            <button onclick="showProjectDetails('E-commerce Website', 'Active', 'Full-stack e-commerce platform with payment integration', 'Nov 1, 2024', '$3,500', 85)" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">View Details</button>
                        </div>
                    </div>
                    
                    <div class="professional-card card-hover">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Mobile App UI</h3>
                            <span class="px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-full">In Review</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">Design mockups for iOS and Android fitness app</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>Due: Nov 30, 2024</span>
                            <span>$3,200</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                            <div class="bg-yellow-600 h-2 rounded-full" style="width: 60%"></div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">60% Complete</span>
                            <button onclick="showProjectDetails('Mobile App UI', 'In Review', 'Design mockups for iOS and Android fitness app', 'Nov 30, 2024', '$3,200', 60)" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">View Details</button>
                        </div>
                    </div>
                    
                    <div class="professional-card card-hover">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Logo Design</h3>
                            <span class="px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full">Completed</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-4">Brand identity design for startup company</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>Due: Oct 15, 2024</span>
                            <span>$1,800</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                            <div class="bg-green-600 h-2 rounded-full" style="width: 100%"></div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">100% Complete</span>
                            <button onclick="showProjectDetails('Logo Design', 'Completed', 'Brand identity design for startup company', 'Oct 15, 2024', '$1,800', 100)" class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">View Details</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Messages Section -->
            <div id="messages-section" class="section hidden">
                <div class="professional-card flex h-[calc(100vh-140px)]">
                    <!-- Messages List (35% width) -->
                    <div class="w-[35%] border-r border-gray-200 flex flex-col">
                        <div class="p-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0">
                            <h3 class="text-lg font-semibold text-gray-900">Messages</h3>
                            <div class="flex items-center space-x-2">
                                <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                <span class="text-xs text-green-600">Online</span>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto">
                            <div class="conversation-item selected">
                                <div class="flex items-center space-x-3">
                                    <div class="relative">
                                        <img src="https://images.unsplash.com/photo-1494790108755-2616b612b647?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                             alt="Sarah" class="w-10 h-10 rounded-full">
                                        <div class="absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">3</div>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center justify-between">
                                            <h4 class="text-sm font-medium text-gray-900">Sarah Johnson</h4>
                                            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        </div>
                                        <p class="text-xs text-gray-500">Can we schedule a call?</p>
                                    </div>
                                    <div class="text-xs text-gray-400">2m</div>
                                </div>
                            </div>
                            <div class="conversation-item">
                                <div class="flex items-center space-x-3">
                                    <div class="relative">
                                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                             alt="Mike" class="w-10 h-10 rounded-full">
                                        <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full"></div>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="text-sm font-medium text-gray-900">Mike Chen</h4>
                                        <p class="text-xs text-gray-500">Great work on the design!</p>
                                    </div>
                                    <div class="text-xs text-gray-400">1h</div>
                                </div>
                            </div>
                            <div class="conversation-item">
                                <div class="flex items-center space-x-3">
                                    <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                         alt="Emma" class="w-10 h-10 rounded-full">
                                    <div class="flex-1">
                                        <h4 class="text-sm font-medium text-gray-900">Emma Wilson</h4>
                                        <p class="text-xs text-gray-500">Invoice received, thank you!</p>
                                    </div>
                                    <div class="text-xs text-gray-400">3h</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Chat Area (65% width) -->
                    <div class="w-[65%] flex flex-col">
                        <!-- Chat Header -->
                        <div class="p-4 border-b border-gray-200 flex items-center space-x-3 flex-shrink-0">
                            <img src="https://images.unsplash.com/photo-1494790108755-2616b612b647?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                 alt="Sarah" class="w-8 h-8 rounded-full">
                            <div>
                                <h4 class="text-sm font-medium text-gray-900">Sarah Johnson</h4>
                                <p class="text-xs text-green-500">Online</p>
                            </div>
                        </div>
                        
                        <!-- Messages Area -->
                        <div id="messages-container" class="flex-1 p-4 space-y-4 overflow-y-auto bg-gray-50">
                            <div class="flex justify-start">
                                <div class="bg-white rounded-lg p-3 max-w-xs shadow-sm">
                                    <p class="text-sm">Hi! I've reviewed the latest designs and they look fantastic. Can we schedule a call to discuss the next steps?</p>
                                    <p class="text-xs text-gray-500 mt-1">10:30 AM</p>
                                </div>
                            </div>
                            <div class="flex justify-end">
                                <div class="bg-blue-600 text-white rounded-lg p-3 max-w-xs">
                                    <p class="text-sm">Thank you! I'm available this afternoon. How about 3 PM?</p>
                                    <p class="text-xs text-blue-200 mt-1">10:32 AM</p>
                                </div>
                            </div>
                            <div class="flex justify-start">
                                <div class="bg-white rounded-lg p-3 max-w-xs shadow-sm">
                                    <p class="text-sm">Perfect! I'll send you the meeting link.</p>
                                    <p class="text-xs text-gray-500 mt-1">10:33 AM</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Typing Indicator -->
                        <div id="typing-indicator" class="px-4 py-2 bg-gray-50 hidden">
                            <div class="flex items-center space-x-2">
                                <div class="bg-white rounded-lg p-2 shadow-sm">
                                    <div class="flex space-x-1">
                                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                                    </div>
                                </div>
                                <span class="text-xs text-gray-500">Sarah is typing...</span>
                            </div>
                        </div>
                        
                        <!-- Message Input (Fixed at bottom) -->
                        <div class="sticky bottom-0 p-4 bg-white border-t border-gray-200 flex-shrink-0" style="border-top: 1px solid #E5E7EB;">
                            <div class="flex items-end space-x-3">
                                <input type="text" 
                                       placeholder="Type your message..." 
                                       class="flex-1 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                                       style="border: 1px solid #E5E7EB; border-radius: 12px; padding: 16px 20px; font-size: 15px; background: white;">
                                <button class="w-12 h-12 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center flex-shrink-0"
                                        style="background-color: #3B82F6; width: 48px; height: 48px;">
                                    <i class="fas fa-paper-plane text-sm"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Invoices Section -->
            <div id="invoices-section" class="section hidden">
                <div class="mb-6">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between">
                        <h2 class="text-2xl font-bold text-gray-900 mb-4 sm:mb-0">Invoices</h2>
                        <div class="flex space-x-3">
                            <button onclick="openNewInvoiceModal()" class="bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-3 rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all duration-300 btn-ripple">
                                <i class="fas fa-plus mr-2"></i>New Invoice
                            </button>
                            <button onclick="exportInvoices()" class="bg-gray-100 text-gray-700 px-4 py-3 rounded-lg hover:bg-gray-200 transition-all duration-300 btn-spinner">
                                <i class="fas fa-download mr-2"></i>Export
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Invoice #</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Due Date</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">#INV-001</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Sarah Johnson</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$2,500.00</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Paid</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Nov 15, 2024</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <button class="text-blue-600 hover:text-blue-900 mr-3">View</button>
                                    <button class="text-gray-600 hover:text-gray-900">Download</button>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">#INV-002</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Mike Chen</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$1,800.00</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Pending</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Dec 1, 2024</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <button class="text-blue-600 hover:text-blue-900 mr-3">View</button>
                                    <button class="text-gray-600 hover:text-gray-900">Send Reminder</button>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">#INV-003</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">TechCorp Inc.</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$5,200.00</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">Overdue</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Oct 30, 2024</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <button class="text-blue-600 hover:text-blue-900 mr-3">View</button>
                                    <button class="text-red-600 hover:text-red-900">Follow Up</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Files Section -->
            <div id="files-section" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Files</h2>
                </div>
                
                <!-- Drag and Drop Area -->
                <div id="dropzone" class="mb-6 border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-blue-500 transition-all duration-300 cursor-pointer relative overflow-hidden">
                    <div class="space-y-4">
                        <div class="mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center transition-transform duration-300 hover:scale-110">
                            <i class="fas fa-cloud-upload-alt text-blue-600 text-2xl animate-bounce-gentle"></i>
                        </div>
                        <div>
                            <p class="text-lg font-medium text-gray-900">Drop files here to upload</p>
                            <p class="text-sm text-gray-500">or click to browse files (Max 10MB per file)</p>
                        </div>
                        <button id="choose-files-btn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-300 btn-ripple btn-burst">
                            <i class="fas fa-folder-open mr-2"></i>Choose Files
                        </button>
                    </div>
                    
                    <!-- Upload Progress -->
                    <div id="upload-progress" class="hidden absolute inset-0 bg-white bg-opacity-95 flex items-center justify-center">
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-4">
                                <div class="w-full h-full border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"></div>
                            </div>
                            <p class="text-lg font-medium text-gray-900">Uploading files...</p>
                            <div class="w-64 bg-gray-200 rounded-full h-2 mt-4">
                                <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                            </div>
                            <p id="progress-text" class="text-sm text-gray-500 mt-2">0%</p>
                        </div>
                    </div>
                    
                    <!-- Success Animation -->
                    <div id="upload-success" class="hidden absolute inset-0 bg-green-50 flex items-center justify-center">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-check text-green-600 text-2xl checkmark"></i>
                            </div>
                            <p class="text-lg font-medium text-green-800">Upload Successful!</p>
                            <p class="text-sm text-green-600">Your files have been uploaded</p>
                        </div>
                    </div>
                </div>
                
                <!-- File Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-3 mb-3">
                            <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-file-pdf text-red-600"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-sm font-medium text-gray-900 truncate">Project_Brief.pdf</h4>
                                <p class="text-xs text-gray-500">2.4 MB</p>
                            </div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500">
                            <span>Oct 15, 2024</span>
                            <button class="text-blue-600 hover:text-blue-800">Download</button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-3 mb-3">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-file-word text-blue-600"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-sm font-medium text-gray-900 truncate">Requirements.docx</h4>
                                <p class="text-xs text-gray-500">1.8 MB</p>
                            </div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500">
                            <span>Oct 10, 2024</span>
                            <button class="text-blue-600 hover:text-blue-800">Download</button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-3 mb-3">
                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-image text-green-600"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-sm font-medium text-gray-900 truncate">mockup_v2.png</h4>
                                <p class="text-xs text-gray-500">5.2 MB</p>
                            </div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500">
                            <span>Oct 5, 2024</span>
                            <button class="text-blue-600 hover:text-blue-800">Download</button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-3 mb-3">
                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-file-archive text-purple-600"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-sm font-medium text-gray-900 truncate">assets.zip</h4>
                                <p class="text-xs text-gray-500">12.5 MB</p>
                            </div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500">
                            <span>Sep 28, 2024</span>
                            <button class="text-blue-600 hover:text-blue-800">Download</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Settings Section -->
            <div id="settings-section" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Settings</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Profile Settings -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-user mr-2 text-blue-600"></i>Profile Settings
                        </h3>
                        <div class="space-y-4">
                            <!-- Profile Picture -->
                            <div class="flex items-center space-x-4">
                                <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" 
                                     class="w-20 h-20 rounded-full border-4 border-blue-100" alt="Profile">
                                <div>
                                    <button onclick="uploadProfilePicture()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                        <i class="fas fa-camera mr-2"></i>Change Photo
                                    </button>
                                    <p class="text-xs text-gray-500 mt-2">JPG, PNG. Max 5MB</p>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                                <input id="profile-name" type="text" value="John Doe" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                <input id="profile-email" type="email" value="john@example.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                <input id="profile-phone" type="tel" value="+1 (555) 123-4567" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Bio</label>
                                <textarea id="profile-bio" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" rows="3">Full-stack developer and designer with 8+ years of experience</textarea>
                            </div>
                            <button onclick="saveProfileSettings()" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                <i class="fas fa-save mr-2"></i>Save Changes
                            </button>
                        </div>
                    </div>
                    
                    <!-- Security Settings -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-lock mr-2 text-blue-600"></i>Security
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Current Password</label>
                                <input id="current-password" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">New Password</label>
                                <input id="new-password" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password</label>
                                <input id="confirm-password" type="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <button onclick="changePassword()" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                <i class="fas fa-key mr-2"></i>Change Password
                            </button>
                            <div class="pt-4 border-t border-gray-200">
                                <h4 class="text-sm font-medium text-gray-900 mb-3">Two-Factor Authentication</h4>
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div>
                                        <p class="text-sm text-gray-700">Status: <span class="text-green-600 font-medium">Enabled</span></p>
                                        <p class="text-xs text-gray-500 mt-1">Via authenticator app</p>
                                    </div>
                                    <button class="text-blue-600 hover:text-blue-800 text-sm font-medium">Manage</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Notification Preferences -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-bell mr-2 text-blue-600"></i>Notifications
                        </h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">Email Notifications</h4>
                                    <p class="text-sm text-gray-500">Receive updates via email</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="email-notif-toggle" type="checkbox" class="sr-only peer" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">Push Notifications</h4>
                                    <p class="text-sm text-gray-500">Browser push notifications</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="push-notif-toggle" type="checkbox" class="sr-only peer" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">New Message Alerts</h4>
                                    <p class="text-sm text-gray-500">Alert when you receive messages</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="message-notif-toggle" type="checkbox" class="sr-only peer" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">Project Updates</h4>
                                    <p class="text-sm text-gray-500">Notify about project changes</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="project-notif-toggle" type="checkbox" class="sr-only peer" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data & Privacy -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-shield-alt mr-2 text-blue-600"></i>Data & Privacy
                        </h3>
                        <div class="space-y-4">
                            <div class="p-4 bg-blue-50 rounded-lg">
                                <h4 class="text-sm font-medium text-blue-900 mb-2">Export Your Data</h4>
                                <p class="text-xs text-blue-700 mb-3">Download all your account data including projects, invoices, and messages</p>
                                <button onclick="exportAllData()" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                    <i class="fas fa-download mr-2"></i>Export All Data
                                </button>
                            </div>
                            <div class="p-4 bg-gray-50 rounded-lg">
                                <h4 class="text-sm font-medium text-gray-900 mb-2">Privacy Settings</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                        <span class="ml-2 text-sm text-gray-700">Show profile to other users</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                                        <span class="ml-2 text-sm text-gray-700">Allow search engines to index</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                        <span class="ml-2 text-sm text-gray-700">Share analytics data</span>
                                    </label>
                                </div>
                            </div>
                            <div class="p-4 bg-red-50 rounded-lg border border-red-200">
                                <h4 class="text-sm font-medium text-red-900 mb-2">Danger Zone</h4>
                                <p class="text-xs text-red-700 mb-3">Once you delete your account, there is no going back</p>
                                <button onclick="deleteAccount()" class="w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm">
                                    <i class="fas fa-trash mr-2"></i>Delete Account
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Accessibility Settings -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-universal-access mr-2 text-blue-600"></i>Accessibility
                        </h3>
                        <div class="space-y-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">High Contrast Mode</h4>
                                    <p class="text-sm text-gray-500">Improve visibility with high contrast colors</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="high-contrast-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle high contrast mode">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">Reduced Motion</h4>
                                    <p class="text-sm text-gray-500">Minimize animations and transitions</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="reduced-motion-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle reduced motion">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">Large Text</h4>
                                    <p class="text-sm text-gray-500">Increase text size for better readability</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="large-text-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle large text">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-sm font-medium text-gray-900">Screen Reader Support</h4>
                                    <p class="text-sm text-gray-500">Enhanced labels and descriptions</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input id="screen-reader-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle screen reader support" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            
                            <div class="pt-4 border-t border-gray-200">
                                <h4 class="text-sm font-medium text-gray-900 mb-3">Keyboard Navigation</h4>
                                <div class="grid grid-cols-2 gap-2 text-xs text-gray-600">
                                    <div><kbd class="px-2 py-1 bg-gray-100 rounded">Tab</kbd> Navigate</div>
                                    <div><kbd class="px-2 py-1 bg-gray-100 rounded">Enter</kbd> Select</div>
                                    <div><kbd class="px-2 py-1 bg-gray-100 rounded">Esc</kbd> Close</div>
                                    <div><kbd class="px-2 py-1 bg-gray-100 rounded">Space</kbd> Toggle</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Time Tracking Section -->
            <div id="time-tracking-section" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">
                        <i class="fas fa-clock mr-2 text-blue-600"></i>Time Tracking
                    </h2>
                    <p class="text-gray-600">Track your time across projects with precision</p>
                </div>

                <!-- Active Timer -->
                <div class="bg-white rounded-2xl shadow-lg mb-6 overflow-hidden border border-gray-200">
                    <!-- Timer Header -->
                    <div class="bg-gradient-to-r from-slate-500 to-blue-500 px-8 py-4">
                        <h3 class="text-lg font-semibold text-white flex items-center">
                            <span class="w-3 h-3 bg-red-500 rounded-full mr-3 animate-pulse shadow-lg shadow-red-500/50"></span>
                            Current Timer
                        </h3>
                    </div>
                    
                    <!-- Timer Content -->
                    <div class="p-8">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div id="current-project-name" class="text-sm text-gray-500 mb-3 font-medium">No active timer</div>
                                <div id="timer-display" class="text-6xl font-bold mb-6 text-gray-900 font-mono tracking-wider">00:00:00</div>
                                <input type="text" id="timer-notes" placeholder="What are you working on?" 
                                       class="w-full px-4 py-3 rounded-lg bg-gray-50 border-2 border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all">
                            </div>
                            <div class="flex flex-col space-y-3 ml-8">
                                <button id="start-timer-btn" onclick="startTimer()" 
                                        class="px-8 py-4 bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white rounded-xl font-semibold transition-all transform hover:scale-105 hover:shadow-xl shadow-lg">
                                    <i class="fas fa-play mr-2"></i>Start
                                </button>
                                <button id="pause-timer-btn" onclick="pauseTimer()" disabled
                                        class="px-8 py-4 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white rounded-xl font-semibold transition-all transform hover:scale-105 hover:shadow-xl shadow-lg disabled:opacity-40 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none">
                                    <i class="fas fa-pause mr-2"></i>Pause
                                </button>
                                <button id="stop-timer-btn" onclick="stopTimer()" disabled
                                        class="px-8 py-4 bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white rounded-xl font-semibold transition-all transform hover:scale-105 hover:shadow-xl shadow-lg disabled:opacity-40 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none">
                                    <i class="fas fa-stop mr-2"></i>Stop
                                </button>
                            </div>
                        </div>
                        
                        <!-- Project Selector -->
                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <label class="block text-sm font-semibold mb-2 text-gray-700">Select Project</label>
                            <select id="timer-project-select" class="w-full px-4 py-3 rounded-lg bg-gray-50 border-2 border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all font-medium">
                                <option value="E-commerce Website">E-commerce Website</option>
                                <option value="Mobile App UI">Mobile App UI</option>
                                <option value="Logo Design">Logo Design</option>
                                <option value="Other">Other Project</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Time Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500 hover:shadow-md transition-shadow">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 text-sm font-medium">Today</span>
                            <div class="w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center">
                                <i class="fas fa-calendar-day text-blue-600"></i>
                            </div>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="today-hours">0.0h</div>
                        <p class="text-xs text-gray-500 mt-1">Daily progress</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-emerald-500 hover:shadow-md transition-shadow">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 text-sm font-medium">This Week</span>
                            <div class="w-10 h-10 bg-emerald-50 rounded-lg flex items-center justify-center">
                                <i class="fas fa-calendar-week text-emerald-600"></i>
                            </div>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="week-hours">0.0h</div>
                        <p class="text-xs text-gray-500 mt-1">Weekly total</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-purple-500 hover:shadow-md transition-shadow">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 text-sm font-medium">This Month</span>
                            <div class="w-10 h-10 bg-purple-50 rounded-lg flex items-center justify-center">
                                <i class="fas fa-calendar-alt text-purple-600"></i>
                            </div>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="month-hours">0.0h</div>
                        <p class="text-xs text-gray-500 mt-1">Monthly total</p>
                    </div>
                    <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl shadow-sm p-6 border-l-4 border-orange-500 hover:shadow-md transition-shadow">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-700 text-sm font-medium">Total Earnings</span>
                            <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-dollar-sign text-orange-600"></i>
                            </div>
                        </div>
                        <div class="text-2xl font-bold text-orange-900" id="total-earnings">$0</div>
                        <p class="text-xs text-orange-600 mt-1 font-medium">🔥 Revenue this month</p>
                    </div>
                </div>

                <!-- Time Entries -->
                <div class="bg-white rounded-xl shadow-sm p-6 border border-slate-200">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                            <i class="fas fa-list-ul mr-2 text-slate-600"></i>
                            Recent Time Entries
                        </h3>
                        <div class="flex items-center gap-2 text-xs">
                            <span class="px-2 py-1 bg-red-50 text-red-600 rounded-full font-medium">
                                <i class="fas fa-exclamation-triangle mr-1"></i>Low hours alert
                            </span>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-50 border-b-2 border-slate-200">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Project</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Description</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Date</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Duration</th>
                                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="time-entries-list" class="divide-y divide-slate-100">
                                <tr>
                                    <td colspan="5" class="px-4 py-12 text-center text-gray-500">
                                        <div class="flex flex-col items-center">
                                            <div class="w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mb-3">
                                                <i class="fas fa-clock text-2xl text-red-400"></i>
                                            </div>
                                            <p class="text-gray-700 font-medium">No time entries yet. Start tracking your time!</p>
                                            <p class="text-sm text-red-600 mt-2">⚠️ You haven't logged any hours today</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Calendar Section -->
            <div id="calendar-section" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">
                        <i class="fas fa-calendar-alt mr-2 text-blue-600"></i>Calendar
                    </h2>
                    <p class="text-gray-600">Manage your schedule, deadlines, and meetings</p>
                </div>

                <!-- Calendar Navigation -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <button onclick="previousMonth()" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                            <i class="fas fa-chevron-left text-gray-600"></i>
                        </button>
                        <h3 id="calendar-month-year" class="text-xl font-bold text-gray-900"></h3>
                        <button onclick="nextMonth()" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                            <i class="fas fa-chevron-right text-gray-600"></i>
                        </button>
                    </div>
                    
                    <!-- Calendar Grid -->
                    <div class="grid grid-cols-7 gap-2">
                        <div class="text-center font-semibold text-gray-600 text-sm py-2">Sun</div>
                        <div class="text-center font-semibold text-gray-600 text-sm py-2">Mon</div>
                        <div class="text-center font-semibold text-gray-600 text-sm py-2">Tue</div>
                        <div class="text-center font-semibold text-gray-600 text-sm py-2">Wed</div>
                        <div class="text-center font-semibold text-gray-600 text-sm py-2">Thu</div>
                        <div class="text-center font-semibold text-gray-600 text-sm py-2">Fri</div>
                        <div class="text-center font-semibold text-gray-600 text-sm py-2">Sat</div>
                    </div>
                    <div id="calendar-days" class="grid grid-cols-7 gap-2 mt-2">
                        <!-- Calendar days will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Upcoming Events -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center justify-between">
                            <span><i class="fas fa-calendar-check mr-2 text-green-600"></i>Upcoming Deadlines</span>
                            <button onclick="addEvent('deadline')" class="text-sm text-blue-600 hover:text-blue-700">
                                <i class="fas fa-plus mr-1"></i>Add
                            </button>
                        </h3>
                        <div id="deadlines-list" class="space-y-3">
                            <div class="flex items-start p-3 bg-red-50 rounded-lg border-l-4 border-red-500">
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-900">E-commerce Website</h4>
                                    <p class="text-sm text-gray-600">Final delivery and review</p>
                                    <p class="text-xs text-red-600 mt-1">
                                        <i class="fas fa-clock mr-1"></i>Nov 1, 2024 - 25 days left
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-start p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-500">
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-900">Mobile App UI</h4>
                                    <p class="text-sm text-gray-600">Design mockups submission</p>
                                    <p class="text-xs text-yellow-600 mt-1">
                                        <i class="fas fa-clock mr-1"></i>Nov 30, 2024 - 54 days left
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center justify-between">
                            <span><i class="fas fa-video mr-2 text-blue-600"></i>Upcoming Meetings</span>
                            <button onclick="addEvent('meeting')" class="text-sm text-blue-600 hover:text-blue-700">
                                <i class="fas fa-plus mr-1"></i>Add
                            </button>
                        </h3>
                        <div id="meetings-list" class="space-y-3">
                            <div class="flex items-start p-3 bg-blue-50 rounded-lg">
                                <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold mr-3">
                                    <div class="text-center">
                                        <div class="text-xs">OCT</div>
                                        <div class="text-lg">08</div>
                                    </div>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-900">Client Review Meeting</h4>
                                    <p class="text-sm text-gray-600">E-commerce project progress review</p>
                                    <p class="text-xs text-blue-600 mt-1">
                                        <i class="fas fa-clock mr-1"></i>2:00 PM - 3:00 PM
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Proposals Section -->
            <div id="proposals-section" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">
                        <i class="fas fa-file-contract mr-2 text-blue-600"></i>AI-Powered Proposals
                    </h2>
                    <p class="text-gray-600">Create professional proposals with AI assistance</p>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <button onclick="createNewProposal()" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl p-6 hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg">
                        <i class="fas fa-sparkles text-3xl mb-3"></i>
                        <h3 class="text-lg font-semibold">Generate with AI</h3>
                        <p class="text-sm opacity-90 mt-2">Create a proposal using AI assistance</p>
                    </button>
                    <button onclick="useProposalTemplate()" class="bg-white border-2 border-blue-200 text-gray-900 rounded-xl p-6 hover:border-blue-400 transition-all transform hover:scale-105">
                        <i class="fas fa-file-alt text-blue-600 text-3xl mb-3"></i>
                        <h3 class="text-lg font-semibold">Use Template</h3>
                        <p class="text-sm text-gray-600 mt-2">Start from a pre-built template</p>
                    </button>
                    <button onclick="importProposal()" class="bg-white border-2 border-purple-200 text-gray-900 rounded-xl p-6 hover:border-purple-400 transition-all transform hover:scale-105">
                        <i class="fas fa-upload text-purple-600 text-3xl mb-3"></i>
                        <h3 class="text-lg font-semibold">Import</h3>
                        <p class="text-sm text-gray-600 mt-2">Import existing proposal</p>
                    </button>
                </div>

                <!-- Proposals List -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Your Proposals</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="proposals-list">
                        <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center">
                            <i class="fas fa-file-contract text-4xl text-gray-300 mb-3"></i>
                            <p class="text-gray-500 mb-4">No proposals yet</p>
                            <button onclick="createNewProposal()" class="text-blue-600 hover:text-blue-700 font-semibold">
                                <i class="fas fa-plus mr-1"></i>Create Your First Proposal
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contracts Section -->
            <div id="contracts-section" class="section hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">
                        <i class="fas fa-file-signature mr-2 text-blue-600"></i>AI-Powered Contracts
                    </h2>
                    <p class="text-gray-600">Create and manage contracts with AI assistance</p>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <button onclick="createNewContract()" class="bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-xl p-6 hover:from-green-700 hover:to-teal-700 transition-all transform hover:scale-105 shadow-lg">
                        <i class="fas fa-robot text-3xl mb-3"></i>
                        <h3 class="text-lg font-semibold">Generate with AI</h3>
                        <p class="text-sm opacity-90 mt-2">Create a contract using AI assistance</p>
                    </button>
                    <button onclick="useContractTemplate()" class="bg-white border-2 border-green-200 text-gray-900 rounded-xl p-6 hover:border-green-400 transition-all transform hover:scale-105">
                        <i class="fas fa-file-contract text-green-600 text-3xl mb-3"></i>
                        <h3 class="text-lg font-semibold">Use Template</h3>
                        <p class="text-sm text-gray-600 mt-2">Start from a legal template</p>
                    </button>
                    <button onclick="importContract()" class="bg-white border-2 border-teal-200 text-gray-900 rounded-xl p-6 hover:border-teal-400 transition-all transform hover:scale-105">
                        <i class="fas fa-file-import text-teal-600 text-3xl mb-3"></i>
                        <h3 class="text-lg font-semibold">Import Contract</h3>
                        <p class="text-sm text-gray-600 mt-2">Import existing contract</p>
                    </button>
                </div>

                <!-- Contract Status -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 text-sm">Active</span>
                            <i class="fas fa-check-circle text-green-600"></i>
                        </div>
                        <div class="text-2xl font-bold text-gray-900">0</div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 text-sm">Pending</span>
                            <i class="fas fa-clock text-yellow-600"></i>
                        </div>
                        <div class="text-2xl font-bold text-gray-900">0</div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 text-sm">Signed</span>
                            <i class="fas fa-pen-fancy text-blue-600"></i>
                        </div>
                        <div class="text-2xl font-bold text-gray-900">0</div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 text-sm">Expired</span>
                            <i class="fas fa-times-circle text-red-600"></i>
                        </div>
                        <div class="text-2xl font-bold text-gray-900">0</div>
                    </div>
                </div>

                <!-- Contracts List -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Your Contracts</h3>
                    <div class="grid grid-cols-1 gap-4" id="contracts-list">
                        <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center">
                            <i class="fas fa-file-signature text-4xl text-gray-300 mb-3"></i>
                            <p class="text-gray-500 mb-4">No contracts yet</p>
                            <button onclick="createNewContract()" class="text-green-600 hover:text-green-700 font-semibold">
                                <i class="fas fa-plus mr-1"></i>Create Your First Contract
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Enhanced Floating Action Button -->
    <div id="fab" class="fixed bottom-8 right-8 z-50">
        <!-- FAB Sub-actions with tooltips -->
        <div id="fab-menu" class="absolute bottom-20 right-0 space-y-4 hidden">
            <div class="relative group">
                <button class="w-14 h-14 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-full shadow-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-300 transform hover:scale-110 flex items-center justify-center fab-sub-action" 
                        data-tooltip="New Project" style="animation-delay: 0.1s">
                    <i class="fas fa-project-diagram text-lg"></i>
                </button>
                <div class="absolute right-16 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap">
                    New Project
                    <div class="absolute right-0 top-1/2 transform translate-x-1 -translate-y-1/2 w-2 h-2 bg-gray-800 rotate-45"></div>
                </div>
            </div>
            
            <div class="relative group">
                <button class="w-14 h-14 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-full shadow-xl hover:from-blue-600 hover:to-indigo-600 transition-all duration-300 transform hover:scale-110 flex items-center justify-center fab-sub-action" 
                        data-tooltip="New Invoice" style="animation-delay: 0.2s">
                    <i class="fas fa-file-invoice-dollar text-lg"></i>
                </button>
                <div class="absolute right-16 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap">
                    New Invoice
                    <div class="absolute right-0 top-1/2 transform translate-x-1 -translate-y-1/2 w-2 h-2 bg-gray-800 rotate-45"></div>
                </div>
            </div>
            
            <div class="relative group">
                <button class="w-14 h-14 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-full shadow-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-110 flex items-center justify-center fab-sub-action" 
                        data-tooltip="Send Message" style="animation-delay: 0.3s">
                    <i class="fas fa-paper-plane text-lg"></i>
                </button>
                <div class="absolute right-16 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap">
                    Send Message
                    <div class="absolute right-0 top-1/2 transform translate-x-1 -translate-y-1/2 w-2 h-2 bg-gray-800 rotate-45"></div>
                </div>
            </div>
            
            <div class="relative group">
                <button class="w-14 h-14 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-full shadow-xl hover:from-orange-600 hover:to-red-600 transition-all duration-300 transform hover:scale-110 flex items-center justify-center fab-sub-action" 
                        data-tooltip="Upload Files" style="animation-delay: 0.4s">
                    <i class="fas fa-cloud-upload-alt text-lg"></i>
                </button>
                <div class="absolute right-16 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap">
                    Upload Files
                    <div class="absolute right-0 top-1/2 transform translate-x-1 -translate-y-1/2 w-2 h-2 bg-gray-800 rotate-45"></div>
                </div>
            </div>
        </div>
        
        <!-- Main FAB Button -->
        <div class="relative group">
            <button id="fab-button" class="fab-enhanced w-16 h-16 text-white rounded-full transition-all duration-300 transform hover:scale-110 flex items-center justify-center relative overflow-hidden focus-ring" 
                    aria-label="Quick actions menu">
                <i class="fas fa-plus text-2xl transition-transform duration-300" id="fab-icon"></i>
                <div class="absolute inset-0 bg-gradient-to-r from-blue-700 to-purple-700 opacity-0 hover:opacity-100 transition-opacity duration-300 rounded-full"></div>
            </button>
            <div class="absolute right-20 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap" id="fab-tooltip">
                Quick Actions
                <div class="absolute right-0 top-1/2 transform translate-x-1 -translate-y-1/2 w-2 h-2 bg-gray-800 rotate-45"></div>
            </div>
            
            <!-- FAB Menu Items -->
            <div id="fab-menu" class="hidden absolute bottom-20 right-0 space-y-3">
                <button onclick="handleFabAction('new-project')" class="fab-sub-action w-12 h-12 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center transition-all duration-300 opacity-0 transform scale-0">
                    <i class="fas fa-project-diagram"></i>
                </button>
                <button onclick="handleFabAction('new-message')" class="fab-sub-action w-12 h-12 bg-blue-500 hover:bg-blue-600 text-white rounded-full flex items-center justify-center transition-all duration-300 opacity-0 transform scale-0">
                    <i class="fas fa-comment"></i>
                </button>
                <button onclick="handleFabAction('new-invoice')" class="fab-sub-action w-12 h-12 bg-purple-500 hover:bg-purple-600 text-white rounded-full flex items-center justify-center transition-all duration-300 opacity-0 transform scale-0">
                    <i class="fas fa-file-invoice"></i>
                </button>
                <button onclick="handleFabAction('upload-file')" class="fab-sub-action w-12 h-12 bg-orange-500 hover:bg-orange-600 text-white rounded-full flex items-center justify-center transition-all duration-300 opacity-0 transform scale-0">
                    <i class="fas fa-upload"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Project Details Modal -->
    <div id="project-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4" style="z-index: 10000;">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto slide-up">
            <div class="sticky top-0 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-t-lg z-10">
                <div class="flex justify-between items-start">
                    <div>
                        <h2 id="modal-title" class="text-2xl font-bold mb-2"></h2>
                        <span id="modal-status" class="px-3 py-1 bg-white bg-opacity-20 rounded-full text-sm"></span>
                    </div>
                    <button onclick="closeProjectModal()" class="text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Project Info -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex items-center space-x-3 p-4 bg-gray-50 rounded-lg">
                        <i class="fas fa-calendar-alt text-blue-600 text-xl"></i>
                        <div>
                            <p class="text-sm text-gray-500">Due Date</p>
                            <p id="modal-date" class="font-semibold text-gray-900"></p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3 p-4 bg-gray-50 rounded-lg">
                        <i class="fas fa-dollar-sign text-green-600 text-xl"></i>
                        <div>
                            <p class="text-sm text-gray-500">Budget</p>
                            <p id="modal-budget" class="font-semibold text-gray-900"></p>
                        </div>
                    </div>
                </div>
                
                <!-- Progress -->
                <div>
                    <div class="flex justify-between mb-2">
                        <span class="text-sm font-medium text-gray-700">Progress</span>
                        <span id="modal-progress-text" class="text-sm font-medium text-blue-600"></span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div id="modal-progress-bar" class="bg-blue-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- Description -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Description</h3>
                    <p id="modal-description" class="text-gray-600"></p>
                </div>
                
                <!-- Tasks/Milestones -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">
                        <i class="fas fa-tasks mr-2 text-blue-600"></i>Milestones
                        <span class="text-sm text-gray-500 font-normal ml-2">(Click to toggle completion)</span>
                    </h3>
                    <div id="project-milestones" class="space-y-2">
                        <div onclick="toggleMilestone(this)" class="milestone-item flex items-center space-x-3 p-3 bg-green-50 rounded-lg cursor-pointer hover:bg-green-100 transition-colors" data-completed="true">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                            <span class="text-gray-700 flex-1">Initial Design Mockups</span>
                            <span class="text-xs text-green-600 font-medium">Completed</span>
                        </div>
                        <div onclick="toggleMilestone(this)" class="milestone-item flex items-center space-x-3 p-3 bg-green-50 rounded-lg cursor-pointer hover:bg-green-100 transition-colors" data-completed="true">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                            <span class="text-gray-700 flex-1">Client Approval</span>
                            <span class="text-xs text-green-600 font-medium">Completed</span>
                        </div>
                        <div onclick="toggleMilestone(this)" class="milestone-item flex items-center space-x-3 p-3 bg-blue-50 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-completed="false">
                            <i class="far fa-circle text-blue-600 text-xl"></i>
                            <span class="text-gray-700 flex-1">Development Phase</span>
                            <span class="text-xs text-blue-600 font-medium">In Progress</span>
                        </div>
                        <div onclick="toggleMilestone(this)" class="milestone-item flex items-center space-x-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors" data-completed="false">
                            <i class="far fa-circle text-gray-400 text-xl"></i>
                            <span class="text-gray-500 flex-1">Testing & Deployment</span>
                            <span class="text-xs text-gray-500 font-medium">Pending</span>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="flex space-x-3 pt-4 border-t">
                    <button onclick="editProject()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-edit mr-2"></i>Edit Project
                    </button>
                    <button onclick="markProjectComplete()" class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-check mr-2"></i>Mark Complete
                    </button>
                    <button onclick="showProjectOptions()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-ellipsis-h"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart Tooltip (at body level for proper positioning) -->
    <div id="chartTooltip" class="chart-tooltip"></div>

    <!-- Invoice Creation Modal -->
    <div id="invoice-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4" style="z-index: 10000;">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto slide-up">
            <div class="sticky top-0 bg-gradient-to-r from-green-600 to-emerald-600 text-white p-6 rounded-t-lg z-10">
                <div class="flex justify-between items-start">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Create New Invoice</h2>
                        <p class="text-green-100 text-sm">Fill in the details to generate your invoice</p>
                    </div>
                    <button onclick="closeInvoiceModal()" class="text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Invoice Header -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Invoice Number</label>
                        <input type="text" id="invoice-number" value="INV-004" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Invoice Date</label>
                        <input type="date" id="invoice-date" value="2024-11-01" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                    </div>
                </div>
                
                <!-- Client Information -->
                <div class="border-t pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">
                        <i class="fas fa-user mr-2 text-green-600"></i>Client Information
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Client Name</label>
                            <input type="text" id="client-name" placeholder="John Smith" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Client Email</label>
                            <input type="email" id="client-email" placeholder="john@example.com" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Client Address</label>
                            <textarea id="client-address" rows="2" placeholder="123 Main St, City, State, ZIP" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"></textarea>
                        </div>
                    </div>
                </div>
                
                <!-- Invoice Items -->
                <div class="border-t pt-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">
                            <i class="fas fa-list mr-2 text-green-600"></i>Invoice Items
                        </h3>
                        <button onclick="addInvoiceItem()" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-lg text-sm transition-colors">
                            <i class="fas fa-plus mr-1"></i>Add Item
                        </button>
                    </div>
                    
                    <div id="invoice-items" class="space-y-3">
                        <!-- Item 1 -->
                        <div class="invoice-item grid grid-cols-12 gap-3 items-end p-3 bg-gray-50 rounded-lg">
                            <div class="col-span-5">
                                <label class="block text-xs font-medium text-gray-700 mb-1">Description</label>
                                <input type="text" placeholder="Service description" class="item-description w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500">
                            </div>
                            <div class="col-span-2">
                                <label class="block text-xs font-medium text-gray-700 mb-1">Quantity</label>
                                <input type="number" value="1" onchange="updateInvoiceCalculations()" class="item-quantity w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500">
                            </div>
                            <div class="col-span-2">
                                <label class="block text-xs font-medium text-gray-700 mb-1">Rate ($)</label>
                                <input type="number" value="0" onchange="updateInvoiceCalculations()" class="item-rate w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500">
                            </div>
                            <div class="col-span-2">
                                <label class="block text-xs font-medium text-gray-700 mb-1">Amount</label>
                                <input type="text" value="$0.00" class="item-amount w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm" readonly>
                            </div>
                            <div class="col-span-1 flex items-center justify-center">
                                <button onclick="removeInvoiceItem(this)" class="text-red-600 hover:text-red-800 p-2">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Totals -->
                <div class="border-t pt-6">
                    <div class="flex justify-end">
                        <div class="w-full md:w-1/2 space-y-3">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Subtotal:</span>
                                <span id="invoice-subtotal" class="font-medium">$0.00</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Tax (10%):</span>
                                <span id="invoice-tax" class="font-medium">$0.00</span>
                            </div>
                            <div class="flex justify-between text-lg font-bold border-t pt-3">
                                <span>Total:</span>
                                <span id="invoice-total" class="text-green-600">$0.00</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Notes -->
                <div class="border-t pt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Notes (Optional)</label>
                    <textarea id="invoice-notes" rows="3" placeholder="Payment terms, thank you message, etc." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"></textarea>
                </div>
                
                <!-- Action Buttons -->
                <div class="flex space-x-3 pt-4 border-t">
                    <button onclick="saveInvoice()" class="flex-1 bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-save mr-2"></i>Create Invoice
                    </button>
                    <button onclick="previewInvoice()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-eye mr-2"></i>Preview
                    </button>
                    <button onclick="closeInvoiceModal()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-medium transition-colors">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Initialize elements
        const sidebar = document.getElementById('sidebar');
        const mobileOverlay = document.getElementById('mobile-overlay');
        
        mobileOverlay.addEventListener('click', () => {
            sidebar.classList.add('-translate-x-full');
            mobileOverlay.classList.add('hidden');
        });
        
        // Sidebar toggle functionality
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const mainContent = document.getElementById('main-content');
        let sidebarOpen = true; // Default open
        
        sidebarToggle.addEventListener('click', () => {
            sidebarOpen = !sidebarOpen;
            
            if (sidebarOpen) {
                // Show sidebar
                sidebar.classList.remove('-translate-x-full');
                document.body.classList.remove('sidebar-hidden');
                document.body.classList.add('sidebar-visible');
                mainContent.style.marginLeft = window.innerWidth >= 1024 ? '16rem' : '0';
                sidebarToggle.querySelector('i').className = 'fas fa-times text-gray-600 group-hover:text-blue-600';
                sidebarToggle.querySelector('.tooltip').textContent = 'Hide Sidebar';
            } else {
                // Hide sidebar
                sidebar.classList.add('-translate-x-full');
                document.body.classList.remove('sidebar-visible');
                document.body.classList.add('sidebar-hidden');
                mainContent.style.marginLeft = '0';
                sidebarToggle.querySelector('i').className = 'fas fa-bars text-gray-600 group-hover:text-blue-600';
                sidebarToggle.querySelector('.tooltip').textContent = 'Show Sidebar';
            }
            
            // Handle mobile overlay
            if (window.innerWidth < 1024) {
                mobileOverlay.classList.toggle('hidden', !sidebarOpen);
            }
        });
        
        // Handle window resize
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024) {
                mobileOverlay.classList.add('hidden');
                // Update margin based on sidebar state
                if (sidebarOpen) {
                    mainContent.style.marginLeft = '16rem';
                } else {
                    mainContent.style.marginLeft = '0';
                }
            } else {
                // On mobile, always no margin
                mainContent.style.marginLeft = '0';
            }
        });
        
        // Enhanced keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Toggle sidebar with Alt + S
            if (e.altKey && e.code === 'KeyS') {
                e.preventDefault();
                sidebarToggle.click();
            }
            
            // Focus search with Ctrl + K
            if (e.ctrlKey && e.code === 'KeyK') {
                e.preventDefault();
                const searchInput = document.querySelector('.search-enhanced');
                if (searchInput) {
                    searchInput.focus();
                }
            }
            
            // ESC to close modals, notifications, or focus search
            if (e.code === 'Escape') {
                // Close any open dropdowns or modals
                document.querySelectorAll('.dropdown-open').forEach(el => {
                    el.classList.remove('dropdown-open');
                });
            }
        });
        
        // Navigation
        function showSection(sectionName, clickedElement) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('border-r-3', 'border-blue-600', 'bg-blue-50', 'text-blue-600');
                item.classList.add('text-gray-700');
            });
            
            // Highlight active nav item if element provided
            if (clickedElement) {
                clickedElement.classList.add('border-r-3', 'border-blue-600', 'bg-blue-50', 'text-blue-600');
                clickedElement.classList.remove('text-gray-700');
            } else {
                // Try to find and highlight the corresponding nav item
                const navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    const href = item.getAttribute('onclick');
                    if (href && href.includes(`'${sectionName}'`)) {
                        item.classList.add('border-r-3', 'border-blue-600', 'bg-blue-50', 'text-blue-600');
                        item.classList.remove('text-gray-700');
                    }
                });
            }
            
            // Close mobile menu if open
            if (window.innerWidth < 1024) {
                sidebar.classList.add('-translate-x-full');
                mobileOverlay.classList.add('hidden');
            }
        }
        
        // Project Details Modal Functions - Store current project data
        let currentProject = {};
        
        function showProjectDetails(title, status, description, date, budget, progress) {
            // Store project data for later use
            currentProject = { title, status, description, date, budget, progress };
            
            // Load saved project data from localStorage
            const savedProjects = JSON.parse(localStorage.getItem('projectData') || '{}');
            const projectKey = title.replace(/\s+/g, '-').toLowerCase();
            const savedProject = savedProjects[projectKey];
            
            // Use saved data if available
            if (savedProject) {
                progress = savedProject.progress;
                status = savedProject.status;
            }
            
            const modal = document.getElementById('project-modal');
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-status').textContent = status;
            document.getElementById('modal-description').textContent = description;
            document.getElementById('modal-date').textContent = date;
            document.getElementById('modal-budget').textContent = budget;
            document.getElementById('modal-progress-text').textContent = progress + '%';
            document.getElementById('modal-progress-bar').style.width = progress + '%';
            
            // Update current project with potentially saved data
            currentProject.progress = progress;
            currentProject.status = status;
            
            // Color progress bar based on completion
            const progressBar = document.getElementById('modal-progress-bar');
            if (progress === 100) {
                progressBar.className = 'bg-green-600 h-3 rounded-full transition-all duration-500';
            } else if (progress >= 60) {
                progressBar.className = 'bg-yellow-600 h-3 rounded-full transition-all duration-500';
            } else {
                progressBar.className = 'bg-blue-600 h-3 rounded-full transition-all duration-500';
            }
            
            // Restore milestone states if saved
            if (savedProject && savedProject.milestones) {
                const milestones = document.querySelectorAll('.milestone-item');
                milestones.forEach((milestone, idx) => {
                    if (savedProject.milestones[idx]) {
                        milestone.setAttribute('data-completed', savedProject.milestones[idx]);
                        if (savedProject.milestones[idx] === 'true') {
                            milestone.className = 'milestone-item flex items-center space-x-3 p-3 bg-green-50 rounded-lg cursor-pointer hover:bg-green-100 transition-colors';
                            milestone.querySelector('i').className = 'fas fa-check-circle text-green-600 text-xl';
                            milestone.querySelector('.text-xs').textContent = 'Completed';
                            milestone.querySelector('.text-xs').className = 'text-xs text-green-600 font-medium';
                            milestone.querySelector('span.flex-1').className = 'text-gray-700 flex-1';
                        }
                    }
                });
            }
            
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
        
        function closeProjectModal() {
            const modal = document.getElementById('project-modal');
            modal.classList.add('hidden');
            document.body.style.overflow = '';
        }
        
        // Save project data to localStorage
        function saveProjectData() {
            const projectKey = currentProject.title.replace(/\s+/g, '-').toLowerCase();
            const savedProjects = JSON.parse(localStorage.getItem('projectData') || '{}');
            
            // Get milestone states
            const milestones = document.querySelectorAll('.milestone-item');
            const milestoneStates = Array.from(milestones).map(m => m.getAttribute('data-completed'));
            
            savedProjects[projectKey] = {
                progress: parseInt(document.getElementById('modal-progress-text').textContent),
                status: document.getElementById('modal-status').textContent,
                milestones: milestoneStates
            };
            
            localStorage.setItem('projectData', JSON.stringify(savedProjects));
        }
        
        // Close modal on backdrop click
        document.getElementById('project-modal')?.addEventListener('click', (e) => {
            if (e.target.id === 'project-modal') {
                closeProjectModal();
            }
        });
        
        // Toggle Milestone Completion
        function toggleMilestone(element) {
            const isCompleted = element.getAttribute('data-completed') === 'true';
            const icon = element.querySelector('i');
            const statusText = element.querySelector('.text-xs');
            
            if (isCompleted) {
                // Mark as incomplete
                element.setAttribute('data-completed', 'false');
                element.className = 'milestone-item flex items-center space-x-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors';
                icon.className = 'far fa-circle text-gray-400 text-xl';
                statusText.textContent = 'Pending';
                statusText.className = 'text-xs text-gray-500 font-medium';
                element.querySelector('span.flex-1').className = 'text-gray-500 flex-1';
                showNotification('Milestone marked as incomplete', 'info');
            } else {
                // Mark as complete
                element.setAttribute('data-completed', 'true');
                element.className = 'milestone-item flex items-center space-x-3 p-3 bg-green-50 rounded-lg cursor-pointer hover:bg-green-100 transition-colors';
                icon.className = 'fas fa-check-circle text-green-600 text-xl';
                statusText.textContent = 'Completed';
                statusText.className = 'text-xs text-green-600 font-medium';
                element.querySelector('span.flex-1').className = 'text-gray-700 flex-1';
                showNotification('Milestone completed! 🎉', 'success');
            }
            
            // Save milestone state
            saveProjectData();
        }
        
        // Edit Project - Actually functional
        function editProject() {
            const projectTitle = document.getElementById('modal-title').textContent;
            const currentDesc = document.getElementById('modal-description').textContent;
            const currentDate = document.getElementById('modal-date').textContent;
            const currentBudget = document.getElementById('modal-budget').textContent;
            
            const editForm = `
                <div id="edit-project-form" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); z-index: 10002; min-width: 500px; max-width: 90vw; max-height: 90vh; overflow-y: auto;">
                    <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 20px; color: #111827; display: flex; align-items: center;">
                        <i class="fas fa-edit mr-3 text-blue-600"></i>Edit Project
                    </h2>
                    <div style="display: flex; flex-direction: column; gap: 20px;">
                        <div>
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Project Name</label>
                            <input id="edit-title" type="text" value="${projectTitle}" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 8px; font-size: 14px;" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Description</label>
                            <textarea id="edit-desc" rows="3" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 8px; font-size: 14px;">${currentDesc}</textarea>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Due Date</label>
                                <input id="edit-date" type="text" value="${currentDate}" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 8px; font-size: 14px;" />
                            </div>
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Budget</label>
                                <input id="edit-budget" type="text" value="${currentBudget}" style="width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 8px; font-size: 14px;" />
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 12px; margin-top: 25px;">
                        <button onclick="saveProjectEdit()" style="flex: 1; padding: 14px; background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
                            <i class="fas fa-save mr-2"></i>Save Changes
                        </button>
                        <button onclick="document.getElementById('edit-project-form').remove(); document.getElementById('edit-backdrop').remove();" style="padding: 14px 20px; background: #F3F4F6; color: #374151; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Cancel</button>
                    </div>
                </div>
                <div id="edit-backdrop" onclick="document.getElementById('edit-project-form').remove(); this.remove();" style="position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 10001;"></div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', editForm);
        }
        
        function saveProjectEdit() {
            const newTitle = document.getElementById('edit-title').value;
            const newDesc = document.getElementById('edit-desc').value;
            const newDate = document.getElementById('edit-date').value;
            const newBudget = document.getElementById('edit-budget').value;
            
            // Update modal
            document.getElementById('modal-title').textContent = newTitle;
            document.getElementById('modal-description').textContent = newDesc;
            document.getElementById('modal-date').textContent = newDate;
            document.getElementById('modal-budget').textContent = newBudget;
            
            // Update current project
            currentProject.title = newTitle;
            currentProject.description = newDesc;
            currentProject.date = newDate;
            currentProject.budget = newBudget;
            
            // Save to localStorage
            saveProjectData();
            
            // Close edit form
            document.getElementById('edit-project-form').remove();
            document.getElementById('edit-backdrop').remove();
            
            showNotification('Project updated successfully! 🎉', 'success');
        }
        
        // Mark Project Complete
        function markProjectComplete() {
            const projectTitle = document.getElementById('modal-title').textContent;
            
            if (confirm(`Are you sure you want to mark "${projectTitle}" as complete?`)) {
                showNotification('Project marked as complete! 🎉', 'success');
                showConfetti();
                
                // Update progress to 100%
                document.getElementById('modal-progress-text').textContent = '100%';
                document.getElementById('modal-progress-bar').style.width = '100%';
                document.getElementById('modal-progress-bar').className = 'bg-green-600 h-3 rounded-full transition-all duration-500';
                document.getElementById('modal-status').textContent = 'Completed';
                
                // Update current project
                currentProject.progress = 100;
                currentProject.status = 'Completed';
                
                // Mark all milestones as complete
                const milestones = document.querySelectorAll('.milestone-item');
                milestones.forEach(milestone => {
                    const isCompleted = milestone.getAttribute('data-completed') === 'true';
                    if (!isCompleted) {
                        milestone.setAttribute('data-completed', 'true');
                        milestone.className = 'milestone-item flex items-center space-x-3 p-3 bg-green-50 rounded-lg cursor-pointer hover:bg-green-100 transition-colors';
                        milestone.querySelector('i').className = 'fas fa-check-circle text-green-600 text-xl';
                        milestone.querySelector('.text-xs').textContent = 'Completed';
                        milestone.querySelector('.text-xs').className = 'text-xs text-green-600 font-medium';
                        milestone.querySelector('span.flex-1').className = 'text-gray-700 flex-1';
                    }
                });
                
                // Save all changes
                saveProjectData();
            }
        }
        
        // Show Project Options Menu
        function showProjectOptions() {
            const options = [
                'Duplicate Project',
                'Archive Project',
                'Share with Team',
                'Export Report',
                'Delete Project'
            ];
            
            const menu = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 10001; min-width: 250px;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 15px; color: #111827;">Project Options</h3>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        ${options.map((opt, idx) => `
                            <button onclick="handleProjectOption('${opt}')" style="padding: 12px; text-align: left; border-radius: 8px; background: ${idx === 4 ? '#FEE2E2' : '#F9FAFB'}; color: ${idx === 4 ? '#DC2626' : '#374151'}; border: none; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='${idx === 4 ? '#FECACA' : '#F3F4F6'}'" onmouseout="this.style.background='${idx === 4 ? '#FEE2E2' : '#F9FAFB'}'">
                                <i class="fas fa-${idx === 0 ? 'copy' : idx === 1 ? 'archive' : idx === 2 ? 'share-alt' : idx === 3 ? 'file-export' : 'trash'} mr-2"></i>${opt}
                            </button>
                        `).join('')}
                    </div>
                    <button onclick="this.parentElement.remove()" style="margin-top: 15px; width: 100%; padding: 10px; background: #E5E7EB; border: none; border-radius: 8px; cursor: pointer; font-weight: 500;">Cancel</button>
                </div>
                <div onclick="this.previousElementSibling.remove(); this.remove();" style="position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 10000;"></div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', menu);
        }
        
        // Handle Project Option Selection - All functional
        function handleProjectOption(option) {
            // Remove the menu
            document.querySelectorAll('[style*="z-index: 10001"]').forEach(el => el.remove());
            document.querySelectorAll('[style*="z-index: 10000"]').forEach(el => el.remove());
            
            const projectTitle = document.getElementById('modal-title').textContent;
            
            switch(option) {
                case 'Duplicate Project':
                    const newTitle = projectTitle + ' (Copy)';
                    showNotification(`Creating duplicate: ${newTitle}`, 'success');
                    setTimeout(() => {
                        showNotification('Project duplicated successfully!', 'success');
                        showConfetti();
                    }, 1000);
                    break;
                    
                case 'Archive Project':
                    if (confirm(`Archive "${projectTitle}"? You can restore it later.`)) {
                        showNotification('Project archived successfully', 'success');
                        const projectKey = projectTitle.replace(/\s+/g, '-').toLowerCase();
                        const savedProjects = JSON.parse(localStorage.getItem('projectData') || '{}');
                        if (savedProjects[projectKey]) {
                            savedProjects[projectKey].archived = true;
                            localStorage.setItem('projectData', JSON.stringify(savedProjects));
                        }
                        setTimeout(() => closeProjectModal(), 1000);
                    }
                    break;
                    
                case 'Share with Team':
                    const shareLink = `${window.location.origin}/project/${projectTitle.replace(/\s+/g, '-').toLowerCase()}`;
                    navigator.clipboard.writeText(shareLink).then(() => {
                        showNotification('Share link copied to clipboard! 📋', 'success');
                    }).catch(() => {
                        showNotification(`Share link: ${shareLink}`, 'info');
                    });
                    break;
                    
                case 'Export Report':
                    showNotification('Generating project report...', 'info');
                    setTimeout(() => {
                        const reportData = {
                            projectName: projectTitle,
                            status: document.getElementById('modal-status').textContent,
                            progress: document.getElementById('modal-progress-text').textContent,
                            budget: document.getElementById('modal-budget').textContent,
                            dueDate: document.getElementById('modal-date').textContent,
                            description: document.getElementById('modal-description').textContent,
                            exportDate: new Date().toISOString(),
                            milestones: Array.from(document.querySelectorAll('.milestone-item')).map(m => ({
                                name: m.querySelector('span.flex-1').textContent,
                                completed: m.getAttribute('data-completed') === 'true'
                            }))
                        };
                        
                        const blob = new Blob([JSON.stringify(reportData, null, 2)], { type: 'application/json' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `${projectTitle.replace(/\s+/g, '-')}-report.json`;
                        a.click();
                        URL.revokeObjectURL(url);
                        
                        showNotification('Report exported successfully! 📊', 'success');
                    }, 1000);
                    break;
                    
                case 'Delete Project':
                    if (confirm(`⚠️ Delete "${projectTitle}"? This action CANNOT be undone!`)) {
                        if (confirm('Are you absolutely sure? All project data will be permanently deleted.')) {
                            showNotification('Project deleted permanently', 'success');
                            const projectKey = projectTitle.replace(/\s+/g, '-').toLowerCase();
                            const savedProjects = JSON.parse(localStorage.getItem('projectData') || '{}');
                            delete savedProjects[projectKey];
                            localStorage.setItem('projectData', JSON.stringify(savedProjects));
                            setTimeout(() => closeProjectModal(), 1000);
                        }
                    }
                    break;
            }
        }
        
        // Help Dropdown Toggle
        function toggleHelpDropdown(event) {
            if (event) {
                event.stopPropagation(); // Prevent event bubbling
            }
            const dropdown = document.getElementById('help-dropdown');
            if (dropdown) {
                const isHidden = dropdown.classList.contains('hidden');
                if (isHidden) {
                    dropdown.classList.remove('hidden');
                    console.log('Help dropdown opened');
                } else {
                    dropdown.classList.add('hidden');
                    console.log('Help dropdown closed');
                }
            } else {
                console.error('Help dropdown element not found');
            }
        }
        
        // Close help dropdown when clicking outside
        document.addEventListener('click', (e) => {
            const helpBtn = e.target.closest('#help-btn');
            const helpDropdown = document.getElementById('help-dropdown');
            
            // If click is outside help button and dropdown, close it
            if (!helpBtn && helpDropdown && !helpDropdown.contains(e.target)) {
                if (!helpDropdown.classList.contains('hidden')) {
                    helpDropdown.classList.add('hidden');
                }
            }
        });
        
        // Settings Functions
        function saveProfileSettings() {
            const name = document.getElementById('profile-name').value;
            const email = document.getElementById('profile-email').value;
            const phone = document.getElementById('profile-phone').value;
            const bio = document.getElementById('profile-bio').value;
            
            // Save to localStorage (in production, this would be an API call)
            localStorage.setItem('userProfile', JSON.stringify({ name, email, phone, bio }));
            
            // Show success message
            showNotification('Profile updated successfully!', 'success');
        }
        
        function changePassword() {
            const current = document.getElementById('current-password').value;
            const newPass = document.getElementById('new-password').value;
            const confirm = document.getElementById('confirm-password').value;
            
            if (!current || !newPass || !confirm) {
                showNotification('Please fill all password fields', 'error');
                return;
            }
            
            if (newPass !== confirm) {
                showNotification('New passwords do not match', 'error');
                return;
            }
            
            if (newPass.length < 8) {
                showNotification('Password must be at least 8 characters', 'error');
                return;
            }
            
            // In production, this would be an API call
            showNotification('Password changed successfully!', 'success');
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
        }
        
        function uploadProfilePicture() {
            // Create hidden file input
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/jpeg,image/png';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        showNotification('File size must be less than 5MB', 'error');
                        return;
                    }
                    showNotification('Profile picture uploaded successfully!', 'success');
                }
            };
            input.click();
        }
        
        function exportAllData() {
            // In production, this would generate actual data
            showNotification('Preparing your data export...', 'info');
            
            setTimeout(() => {
                const data = {
                    profile: JSON.parse(localStorage.getItem('userProfile') || '{}'),
                    projects: ['E-commerce Website', 'Mobile App UI', 'Logo Design'],
                    invoices: ['INV-001', 'INV-002', 'INV-003'],
                    messages: 'All conversations',
                    exportDate: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'my-data-export.json';
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification('Data exported successfully!', 'success');
            }, 1500);
        }
        
        function deleteAccount() {
            if (confirm('Are you sure you want to delete your account? This action cannot be undone!')) {
                if (confirm('This will permanently delete all your data. Are you absolutely sure?')) {
                    showNotification('Account deletion initiated. You will be logged out.', 'info');
                    setTimeout(() => {
                        // In production, this would be an API call
                        window.location.href = '/goodbye.html';
                    }, 2000);
                }
            }
        }
        
        // Invoice Functions
        function openNewInvoiceModal() {
            const modal = document.getElementById('invoice-modal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            
            // Set today's date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('invoice-date').value = today;
            
            // Calculate next invoice number
            const nextNum = String(Math.floor(Math.random() * 100) + 4).padStart(3, '0');
            document.getElementById('invoice-number').value = 'INV-' + nextNum;
            
            // Initialize invoice calculations
            updateInvoiceCalculations();
        }
        
        function closeInvoiceModal() {
            const modal = document.getElementById('invoice-modal');
            modal.classList.add('hidden');
            document.body.style.overflow = '';
        }
        
        function addInvoiceItem() {
            const container = document.getElementById('invoice-items');
            const itemHTML = `
                <div class="invoice-item grid grid-cols-12 gap-3 items-end p-3 bg-gray-50 rounded-lg">
                    <div class="col-span-5">
                        <label class="block text-xs font-medium text-gray-700 mb-1">Description</label>
                        <input type="text" placeholder="Service description" class="item-description w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-xs font-medium text-gray-700 mb-1">Quantity</label>
                        <input type="number" value="1" onchange="updateInvoiceCalculations()" class="item-quantity w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-xs font-medium text-gray-700 mb-1">Rate ($)</label>
                        <input type="number" value="0" onchange="updateInvoiceCalculations()" class="item-rate w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-xs font-medium text-gray-700 mb-1">Amount</label>
                        <input type="text" value="$0.00" class="item-amount w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm" readonly>
                    </div>
                    <div class="col-span-1 flex items-center justify-center">
                        <button onclick="removeInvoiceItem(this)" class="text-red-600 hover:text-red-800 p-2">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', itemHTML);
        }
        
        function removeInvoiceItem(button) {
            const item = button.closest('.invoice-item');
            if (document.querySelectorAll('.invoice-item').length > 1) {
                item.remove();
                updateInvoiceCalculations();
            } else {
                showNotification('Invoice must have at least one item', 'warning');
            }
        }
        
        function updateInvoiceCalculations() {
            let subtotal = 0;
            
            document.querySelectorAll('.invoice-item').forEach(item => {
                const quantity = parseFloat(item.querySelector('.item-quantity').value) || 0;
                const rate = parseFloat(item.querySelector('.item-rate').value) || 0;
                const amount = quantity * rate;
                
                item.querySelector('.item-amount').value = '$' + amount.toFixed(2);
                subtotal += amount;
            });
            
            const tax = subtotal * 0.1; // 10% tax
            const total = subtotal + tax;
            
            document.getElementById('invoice-subtotal').textContent = '$' + subtotal.toFixed(2);
            document.getElementById('invoice-tax').textContent = '$' + tax.toFixed(2);
            document.getElementById('invoice-total').textContent = '$' + total.toFixed(2);
        }
        
        function saveInvoice() {
            const invoiceNumber = document.getElementById('invoice-number').value;
            const clientName = document.getElementById('client-name').value;
            const total = document.getElementById('invoice-total').textContent;
            
            if (!clientName) {
                showNotification('Please enter client name', 'error');
                return;
            }
            
            // In production, this would save to backend
            showNotification('Invoice ' + invoiceNumber + ' created successfully!', 'success');
            showConfetti();
            
            setTimeout(() => {
                closeInvoiceModal();
                showSection('invoices');
            }, 1500);
        }
        
        function previewInvoice() {
            showNotification('Invoice preview feature coming soon!', 'info');
        }
        
        // Add event listeners to initial invoice items
        document.addEventListener('DOMContentLoaded', () => {
            const invoiceItems = document.querySelectorAll('#invoice-items .item-quantity, #invoice-items .item-rate');
            invoiceItems.forEach(input => {
                input.addEventListener('change', updateInvoiceCalculations);
            });
        });
        
        function exportInvoices() {
            showNotification('Exporting invoices...', 'info');
            
            setTimeout(() => {
                // Create CSV content
                const csvContent = `Invoice #,Client,Amount,Status,Date
INV-001,Sarah Johnson,$3500,Paid,Oct 15 2024
INV-002,Michael Chen,$2500,Pending,Oct 20 2024
INV-003,Emily Davis,$1800,Paid,Oct 25 2024`;
                
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'invoices-export.csv';
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification('Invoices exported successfully!', 'success');
            }, 1000);
        }
        
        // Notification System
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-[10000] slide-up`;
            notification.innerHTML = `
                <div class="flex items-center space-x-2">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        
        // Enhanced Theme toggle with proper functionality
        const themeToggle = document.getElementById('theme-toggle');
        let isDark = localStorage.getItem('theme') === 'dark' || false;
        
        // Apply saved theme on load
        if (isDark) {
            document.body.classList.add('dark');
            document.documentElement.classList.add('dark');
        }
        
        themeToggle?.addEventListener('click', () => {
            isDark = !isDark;
            if (isDark) {
                document.body.classList.add('dark');
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                showSuccessAnimation(themeToggle, 'Dark mode enabled!');
            } else {
                document.body.classList.remove('dark');
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                showSuccessAnimation(themeToggle, 'Light mode enabled!');
            }
            if (isDark) {
                document.body.classList.add('dark');
                themeToggle.innerHTML = '<i class="fas fa-sun text-yellow-500"></i>';
            } else {
                document.body.classList.remove('dark');
                themeToggle.innerHTML = '<i class="fas fa-moon text-gray-600"></i>';
            }
        });
        
        // Drag and drop functionality
        const dropzone = document.getElementById('dropzone');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropzone.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        ['dragenter', 'dragover'].forEach(eventName => {
            dropzone.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropzone.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight(e) {
            dropzone.classList.add('border-blue-500', 'bg-blue-50');
        }
        
        function unhighlight(e) {
            dropzone.classList.remove('border-blue-500', 'bg-blue-50');
        }
        
        dropzone.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            // Handle file upload here
            console.log('Files dropped:', files);
            alert(`${files.length} file(s) ready to upload!`);
        }
        
        // Click to upload
        dropzone.addEventListener('click', () => {
            const input = document.createElement('input');
            input.type = 'file';
            input.multiple = true;
            input.click();
            
            input.addEventListener('change', (e) => {
                const files = e.target.files;
                console.log('Files selected:', files);
                alert(`${files.length} file(s) selected!`);
            });
        });
        
        // Smooth animations on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-slide-up');
                }
            });
        }, observerOptions);
        
        // Observe cards for animation
        document.querySelectorAll('.card-hover').forEach(card => {
            observer.observe(card);
        });
        
        // Enhanced file upload with progress animation
        let uploadFiles = [];
        
        function simulateUpload() {
            const uploadProgressDiv = document.getElementById('upload-progress');
            const uploadSuccessDiv = document.getElementById('upload-success');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            
            uploadProgressDiv.classList.remove('hidden');
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                progressBar.style.width = progress + '%';
                progressText.textContent = Math.round(progress) + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        uploadProgressDiv.classList.add('hidden');
                        uploadSuccessDiv.classList.remove('hidden');
                        
                        setTimeout(() => {
                            uploadSuccessDiv.classList.add('hidden');
                        }, 3000);
                    }, 500);
                }
            }, 200);
        }
        
        // Interactive chart functionality
        function initChart() {
            const canvas = document.getElementById('revenueChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const tooltip = document.getElementById('chartTooltip');
            
            // Chart data
            const data = [
                { month: 'Jan', revenue: 8500, projects: 3 },
                { month: 'Feb', revenue: 12200, projects: 5 },
                { month: 'Mar', revenue: 9800, projects: 4 },
                { month: 'Apr', revenue: 15600, projects: 7 },
                { month: 'May', revenue: 11400, projects: 6 },
                { month: 'Jun', revenue: 18200, projects: 8 }
            ];
            
            // Simple chart drawing
            const width = canvas.width = canvas.offsetWidth;
            const height = canvas.height = canvas.offsetHeight;
            
            const padding = 60;
            const chartWidth = width - padding * 2;
            const chartHeight = height - padding * 2;
            
            const maxRevenue = Math.max(...data.map(d => d.revenue));
            const scaleY = chartHeight / maxRevenue;
            const scaleX = chartWidth / (data.length - 1);
            
            // Draw chart
            function drawChart() {
                ctx.clearRect(0, 0, width, height);
                
                // Subtle horizontal gridlines aligned with Y-axis values
                ctx.strokeStyle = '#F3F4F6';
                ctx.lineWidth = 0.5;
                ctx.globalAlpha = 0.6;
                
                // Draw gridlines at specific dollar values: $0, $3k, $6k, $9k, $12k, $15k
                const gridValues = [0, 3000, 6000, 9000, 12000, 15000];
                gridValues.forEach(value => {
                    const y = height - padding - (value / maxRevenue) * chartHeight;
                    ctx.beginPath();
                    ctx.moveTo(padding, y);
                    ctx.lineTo(width - padding, y);
                    ctx.stroke();
                });
                
                // Reset alpha for other elements
                ctx.globalAlpha = 1.0;
                
                // Y-axis labels (dollar values)
                ctx.fillStyle = '#9CA3AF';
                ctx.font = '12px Inter';
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                
                const yLabels = ['$15k', '$12k', '$9k', '$6k', '$3k', '$0'];
                gridValues.reverse().forEach((value, index) => {
                    const y = height - padding - (value / maxRevenue) * chartHeight;
                    ctx.fillText(yLabels[index], padding - 10, y);
                });
                gridValues.reverse(); // Reset the array order
                
                // Revenue line
                ctx.strokeStyle = '#3b82f6';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                data.forEach((point, index) => {
                    const x = padding + index * scaleX;
                    const y = height - padding - (point.revenue * scaleY);
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                
                ctx.stroke();
                
                // Enhanced data points with white borders
                data.forEach((point, index) => {
                    const x = padding + index * scaleX;
                    const y = height - padding - (point.revenue * scaleY);
                    
                    // White border
                    ctx.fillStyle = '#ffffff';
                    ctx.beginPath();
                    ctx.arc(x, y, 6, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // Blue center
                    ctx.fillStyle = '#3b82f6';
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, Math.PI * 2);
                    ctx.fill();
                });
                
                // X-axis labels (months)
                ctx.fillStyle = '#6b7280';
                ctx.font = '12px Inter';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'top';
                
                data.forEach((point, index) => {
                    const x = padding + index * scaleX;
                    ctx.fillText(point.month, x, height - 10);
                });
            }
            
            drawChart();
            
            // Chart interactions
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // Find nearest data point
                let nearestIndex = -1;
                let minDistance = Infinity;
                
                data.forEach((point, index) => {
                    const pointX = padding + index * scaleX;
                    const pointY = height - padding - (point.revenue * scaleY);
                    const distance = Math.sqrt((x - pointX) ** 2 + (y - pointY) ** 2);
                    
                    if (distance < 20 && distance < minDistance) {
                        minDistance = distance;
                        nearestIndex = index;
                    }
                });
                
                if (nearestIndex >= 0) {
                    const point = data[nearestIndex];
                    const pointX = padding + nearestIndex * scaleX;
                    const pointY = height - padding - (point.revenue * scaleY);
                    
                    tooltip.innerHTML = `
                        <strong>${point.month}</strong>
                        <div style="margin-top: 4px;">Revenue: <span style="color: #60A5FA; font-weight: 600;">$${point.revenue.toLocaleString()}</span></div>
                        <div>Projects: <span style="color: #34D399; font-weight: 600;">${point.projects}</span></div>
                    `;
                    
                    // Get canvas position relative to window
                    const canvasRect = canvas.getBoundingClientRect();
                    
                    // Position tooltip ABOVE the data point
                    const tooltipWidth = 170;
                    const tooltipHeight = 85;
                    
                    // Calculate position: to the right and ABOVE the point
                    let left = canvasRect.left + pointX + 15;
                    let top = canvasRect.top + pointY - tooltipHeight - 10; // Position ABOVE the point
                    
                    // If tooltip goes off right edge, show it on left side
                    if (left + tooltipWidth > window.innerWidth - 20) {
                        left = canvasRect.left + pointX - tooltipWidth - 15;
                    }
                    
                    // If tooltip goes off left edge, keep it visible
                    if (left < 10) {
                        left = 10;
                    }
                    
                    // If tooltip would go above viewport, position it below the point instead
                    if (top < 150) {
                        top = canvasRect.top + pointY + 20;
                    }
                    
                    tooltip.style.left = left + 'px';
                    tooltip.style.top = top + 'px';
                    tooltip.classList.add('active');
                } else {
                    tooltip.classList.remove('active');
                }
            });
            
            canvas.addEventListener('mouseleave', () => {
                tooltip.classList.remove('active');
            });
        }
        
        // Enhanced Settings & Accessibility features
        function initializeSettings() {
            const highContrastToggle = document.getElementById('high-contrast-toggle');
            const reducedMotionToggle = document.getElementById('reduced-motion-toggle');
            const largeTextToggle = document.getElementById('large-text-toggle');
            
            // Load saved settings
            const savedSettings = JSON.parse(localStorage.getItem('userSettings') || '{}');
            
            // High contrast toggle
            if (highContrastToggle) {
                highContrastToggle.checked = savedSettings.highContrast || false;
                if (savedSettings.highContrast) {
                    document.body.classList.add('high-contrast');
                }
                
                highContrastToggle.addEventListener('change', (e) => {
                    const enabled = e.target.checked;
                    if (enabled) {
                        document.body.classList.add('high-contrast');
                        showSuccessAnimation(e.target, 'High contrast enabled!');
                    } else {
                        document.body.classList.remove('high-contrast');
                        showSuccessAnimation(e.target, 'High contrast disabled!');
                    }
                    
                    savedSettings.highContrast = enabled;
                    localStorage.setItem('userSettings', JSON.stringify(savedSettings));
                });
            }
            
            // Reduced motion toggle
            if (reducedMotionToggle) {
                reducedMotionToggle.checked = savedSettings.reducedMotion || false;
                if (savedSettings.reducedMotion) {
                    document.body.classList.add('reduce-motion');
                }
                
                reducedMotionToggle.addEventListener('change', (e) => {
                    const enabled = e.target.checked;
                    if (enabled) {
                        document.body.classList.add('reduce-motion');
                        showSuccessAnimation(e.target, 'Reduced motion enabled!');
                    } else {
                        document.body.classList.remove('reduce-motion');
                        showSuccessAnimation(e.target, 'Animations restored!');
                    }
                    
                    savedSettings.reducedMotion = enabled;
                    localStorage.setItem('userSettings', JSON.stringify(savedSettings));
                });
            }
            
            // Large text toggle
            if (largeTextToggle) {
                largeTextToggle.checked = savedSettings.largeText || false;
                if (savedSettings.largeText) {
                    document.body.style.fontSize = '18px';
                }
                
                largeTextToggle.addEventListener('change', (e) => {
                    const enabled = e.target.checked;
                    if (enabled) {
                        document.body.style.fontSize = '18px';
                        showSuccessAnimation(e.target, 'Large text enabled!');
                    } else {
                        document.body.style.fontSize = '';
                        showSuccessAnimation(e.target, 'Normal text size restored!');
                    }
                    
                    savedSettings.largeText = enabled;
                    localStorage.setItem('userSettings', JSON.stringify(savedSettings));
                });
            }
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            // ESC to close modals or FAB
            if (e.key === 'Escape') {
                if (fabOpen) {
                    fabMenu.classList.add('hidden');
                    fabButton.innerHTML = '<i class="fas fa-plus text-xl"></i>';
                    fabButton.classList.remove('rotate-45');
                    fabOpen = false;
                }
            }
            
            // Enter to trigger buttons
            if (e.key === 'Enter' && e.target.tagName === 'BUTTON') {
                e.target.click();
            }
        });
        
        // Send message function
        function sendMessage(message) {
            const chatWindow = document.getElementById('messages-container');
            if (!chatWindow) return;
            
            // Add the new message
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex justify-end animate-slide-up';
            messageDiv.innerHTML = `
                <div class="bg-blue-600 text-white rounded-lg p-3 max-w-xs">
                    <p class="text-sm">${message}</p>
                    <p class="text-xs text-blue-200 mt-1">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</p>
                </div>
            `;
            
            chatWindow.appendChild(messageDiv);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            
            // Show typing indicator after 1 second
            const typingIndicator = document.getElementById('typing-indicator');
            setTimeout(() => {
                if (typingIndicator) {
                    typingIndicator.classList.remove('hidden');
                }
                
                // Simulate reply after 2 seconds
                setTimeout(() => {
                    if (typingIndicator) {
                        typingIndicator.classList.add('hidden');
                    }
                    
                    const replyDiv = document.createElement('div');
                    replyDiv.className = 'flex justify-start animate-slide-up';
                    replyDiv.innerHTML = `
                        <div class="bg-white rounded-lg p-3 max-w-xs shadow-sm">
                            <p class="text-sm">Thanks for your message! I'll get back to you shortly.</p>
                            <p class="text-xs text-gray-500 mt-1">Just now</p>
                        </div>
                    `;
                    
                    chatWindow.appendChild(replyDiv);
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                }, 2000);
            }, 1000);
        }
        
        // Initialize chat functionality
        function initializeChat() {
            const messageInput = document.querySelector('#messages-section input[type="text"]');
            const sendButton = document.querySelector('#messages-section button');
            
            if (messageInput && sendButton) {
                // Send message on button click
                sendButton.addEventListener('click', () => {
                    const message = messageInput.value.trim();
                    if (message) {
                        sendMessage(message);
                        messageInput.value = '';
                        showSuccessAnimation(sendButton, 'Message sent!');
                    }
                });
                
                // Send message on Enter key
                messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        const message = messageInput.value.trim();
                        if (message) {
                            sendMessage(message);
                            messageInput.value = '';
                            showSuccessAnimation(messageInput, 'Message sent!');
                        }
                    }
                });
                
                // Conversation item click handlers
                const conversationItems = document.querySelectorAll('.conversation-item');
                conversationItems.forEach(item => {
                    item.addEventListener('click', () => {
                        // Remove selected class from all items
                        conversationItems.forEach(i => i.classList.remove('selected'));
                        // Add selected class to clicked item
                        item.classList.add('selected');
                        
                        // Update chat header
                        const name = item.querySelector('h4').textContent;
                        const chatHeader = document.querySelector('#messages-section .border-b h4');
                        if (chatHeader) {
                            chatHeader.textContent = name;
                        }
                        
                        showSuccessAnimation(item, `Switched to ${name}!`);
                    });
                });
            }
        }
        
        // Enhanced FAB functionality with working actions
        const fabButton = document.getElementById('fab-button');
        const fabMenu = document.getElementById('fab-menu');
        const fabIcon = document.getElementById('fab-icon');
        const fabTooltip = document.getElementById('fab-tooltip');
        let fabOpen = false;
        
        fabButton?.addEventListener('click', () => {
            fabOpen = !fabOpen;
            if (fabOpen) {
                fabMenu.classList.remove('hidden');
                fabIcon.style.transform = 'rotate(45deg)';
                fabTooltip.textContent = 'Close Menu';
                
                // Animate sub-actions
                const subActions = document.querySelectorAll('.fab-sub-action');
                subActions.forEach((action, index) => {
                    setTimeout(() => {
                        action.style.transform = 'scale(1) translateY(0)';
                        action.style.opacity = '1';
                    }, index * 100);
                });
            } else {
                fabMenu.classList.add('hidden');
                fabIcon.style.transform = 'rotate(0deg)';
                fabTooltip.textContent = 'Quick Actions';
            }
        });
        
        // FAB Action handlers
        function handleFabAction(actionType) {
            fabOpen = false;
            fabMenu.classList.add('hidden');
            fabIcon.style.transform = 'rotate(0deg)';
            fabTooltip.textContent = 'Quick Actions';
            
            switch(actionType) {
                case 'new-project':
                    showSection('projects');
                    showSuccessAnimation(null, 'Navigated to Projects!');
                    // Simulate new project modal
                    setTimeout(() => {
                        showSuccessAnimation(null, 'New Project Form Ready!');
                    }, 500);
                    break;
                    
                case 'new-message':
                    showSection('messages');
                    showSuccessAnimation(null, 'Opening Messages!');
                    // Focus on message input
                    setTimeout(() => {
                        const messageInput = document.querySelector('#messages-section input[type="text"]');
                        if (messageInput) {
                            messageInput.focus();
                        }
                    }, 500);
                    break;
                    
                case 'new-invoice':
                    showSection('invoices');
                    showSuccessAnimation(null, 'Creating New Invoice!');
                    // Simulate invoice creation
                    setTimeout(() => {
                        showConfetti();
                        showSuccessAnimation(null, 'Invoice Template Ready!');
                    }, 800);
                    break;
                    
                case 'upload-file':
                    showSection('files');
                    showSuccessAnimation(null, 'File Upload Ready!');
                    // Simulate file upload interface
                    setTimeout(() => {
                        // Trigger file input
                        const fileInput = document.createElement('input');
                        fileInput.type = 'file';
                        fileInput.multiple = true;
                        fileInput.onchange = (e) => {
                            const files = Array.from(e.target.files);
                            showSuccessAnimation(null, `${files.length} file(s) selected!`);
                            showConfetti();
                        };
                        fileInput.click();
                    }, 500);
                    break;
            }
        }
        
        // Counter animation for dashboard cards
        function animateCounters() {
            const counters = document.querySelectorAll('.counter');
            counters.forEach(counter => {
                const target = parseInt(counter.getAttribute('data-target'));
                const prefix = counter.getAttribute('data-prefix') || '';
                const duration = 2000;
                const step = target / (duration / 16);
                let current = 0;
                
                const updateCounter = () => {
                    current += step;
                    if (current < target) {
                        counter.textContent = prefix + Math.floor(current).toLocaleString();
                        requestAnimationFrame(updateCounter);
                    } else {
                        counter.textContent = prefix + target.toLocaleString();
                    }
                };
                
                // Start animation when element is visible
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            setTimeout(updateCounter, Math.random() * 500);
                            observer.unobserve(entry.target);
                        }
                    });
                });
                
                observer.observe(counter);
            });
        }
        
        // Enhanced notifications
        const notificationsBtn = document.getElementById('notifications-btn');
        const notificationsDropdown = document.getElementById('notifications-dropdown');
        
        notificationsBtn?.addEventListener('click', (e) => {
            e.stopPropagation();
            notificationsDropdown.classList.toggle('hidden');
        });
        
        document.addEventListener('click', () => {
            if (!notificationsDropdown.classList.contains('hidden')) {
                notificationsDropdown.classList.add('hidden');
            }
        });
        
        // Enhanced search functionality with real filtering
        function initSearch() {
            const searchInputs = document.querySelectorAll('input[type="text"]');
            searchInputs.forEach(input => {
                if (input.placeholder.includes('search') || input.placeholder.includes('Search')) {
                    input.addEventListener('input', (e) => {
                        const query = e.target.value.toLowerCase().trim();
                        performSearch(query, input);
                        
                        // Visual feedback
                        if (query.length > 0) {
                            input.classList.add('border-blue-500', 'ring-2', 'ring-blue-200');
                        } else {
                            input.classList.remove('border-blue-500', 'ring-2', 'ring-blue-200');
                        }
                    });
                    
                    // Add search icon interaction
                    input.addEventListener('focus', () => {
                        const searchIcon = input.parentElement.querySelector('.fa-search');
                        if (searchIcon) {
                            searchIcon.classList.add('text-blue-500');
                        }
                    });
                    
                    input.addEventListener('blur', () => {
                        const searchIcon = input.parentElement.querySelector('.fa-search');
                        if (searchIcon) {
                            searchIcon.classList.remove('text-blue-500');
                        }
                    });
                }
            });
        }
        
        function performSearch(query, searchInput) {
            const currentSection = document.querySelector('.section:not(.hidden)');
            if (!currentSection) return;
            
            // Projects search
            if (currentSection.id === 'projects-section') {
                const projectCards = currentSection.querySelectorAll('.bg-white.rounded-xl');
                projectCards.forEach(card => {
                    const text = card.textContent.toLowerCase();
                    if (query === '' || text.includes(query)) {
                        card.style.display = 'block';
                        card.style.opacity = '1';
                    } else {
                        card.style.display = 'none';
                    }
                });
            }
            
            // Messages search
            if (currentSection.id === 'messages-section') {
                const conversations = currentSection.querySelectorAll('.conversation-item');
                conversations.forEach(conv => {
                    const text = conv.textContent.toLowerCase();
                    if (query === '' || text.includes(query)) {
                        conv.style.display = 'block';
                    } else {
                        conv.style.display = 'none';
                    }
                });
            }
            
            // Invoices search
            if (currentSection.id === 'invoices-section') {
                const invoiceRows = currentSection.querySelectorAll('tbody tr');
                invoiceRows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    if (query === '' || text.includes(query)) {
                        row.style.display = 'table-row';
                    } else {
                        row.style.display = 'none';
                    }
                });
            }
            
            console.log('Searching for:', query);
        }
        
        // Micro-interactions and success animations
        function showSuccessAnimation(element, message = 'Success!') {
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center space-x-2 animate-slide-up';
            successDiv.innerHTML = `
                <i class="fas fa-check-circle text-xl animate-pulse"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.style.transform = 'translateX(100%)';
                successDiv.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(successDiv);
                }, 300);
            }, 3000);
        }
        
        // Enhanced file upload with confetti effect
        function showConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '-10px';
                confetti.style.width = '10px';
                confetti.style.height = '10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.pointerEvents = 'none';
                confetti.style.zIndex = '1000';
                confetti.style.borderRadius = '50%';
                
                document.body.appendChild(confetti);
                
                const animation = confetti.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(100vh) rotate(${Math.random() * 360}deg)`, opacity: 0 }
                ], {
                    duration: Math.random() * 2000 + 1000,
                    easing: 'ease-out'
                });
                
                animation.onfinish = () => {
                    document.body.removeChild(confetti);
                };
            }
        }
        
        // Enhanced progress bar animations
        function animateProgressBars() {
            const progressBars = document.querySelectorAll('[style*="width:"]');
            progressBars.forEach(bar => {
                const finalWidth = bar.style.width;
                bar.style.width = '0%';
                bar.style.transition = 'width 1.5s cubic-bezier(0.4, 0, 0.2, 1)';
                
                setTimeout(() => {
                    bar.style.width = finalWidth;
                }, Math.random() * 500);
            });
        }
        
        // Enhanced keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Enhanced ESC functionality
            if (e.key === 'Escape') {
                if (fabOpen) {
                    fabMenu.classList.add('hidden');
                    fabIcon.style.transform = 'rotate(0deg)';
                    fabTooltip.textContent = 'Quick Actions';
                    fabOpen = false;
                }
                if (!notificationsDropdown.classList.contains('hidden')) {
                    notificationsDropdown.classList.add('hidden');
                }
            }
            
            // Global shortcuts
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'k':
                        e.preventDefault();
                        document.querySelector('input[placeholder*="search"]')?.focus();
                        break;
                    case '1':
                        e.preventDefault();
                        showSection('dashboard');
                        break;
                    case '2':
                        e.preventDefault();
                        showSection('projects');
                        break;
                    case '3':
                        e.preventDefault();
                        showSection('messages');
                        break;
                }
            }
        });
        
        // Activity item click handlers
        function makeActivityClickable() {
            const activityItems = document.querySelectorAll('#recent-activity .flex');
            activityItems.forEach(item => {
                item.style.cursor = 'pointer';
                item.classList.add('hover:bg-gray-50', 'transition-colors', 'duration-200', 'rounded-lg', 'p-2', '-m-2');
                
                item.addEventListener('click', () => {
                    const text = item.querySelector('p').textContent;
                    if (text.includes('message')) {
                        showSection('messages');
                    } else if (text.includes('invoice')) {
                        showSection('invoices');
                    } else if (text.includes('project')) {
                        showSection('projects');
                    }
                    showSuccessAnimation(item, 'Navigating...');
                });
            });
        }

        // ========================================
        // TIME TRACKING FUNCTIONS
        // ========================================
        let timerInterval = null;
        let timerSeconds = 0;
        let timerRunning = false;
        let timerPaused = false;
        let timeEntries = JSON.parse(localStorage.getItem('timeEntries') || '[]');

        function startTimer() {
            const project = document.getElementById('timer-project-select').value;
            document.getElementById('current-project-name').textContent = project;
            
            timerRunning = true;
            timerPaused = false;
            document.getElementById('start-timer-btn').disabled = true;
            document.getElementById('pause-timer-btn').disabled = false;
            document.getElementById('stop-timer-btn').disabled = false;
            
            timerInterval = setInterval(() => {
                timerSeconds++;
                updateTimerDisplay();
            }, 1000);
            
            showNotification('Timer started! ⏱️', 'success');
        }

        function pauseTimer() {
            if (timerRunning && !timerPaused) {
                clearInterval(timerInterval);
                timerPaused = true;
                document.getElementById('pause-timer-btn').innerHTML = '<i class="fas fa-play mr-2"></i>Resume';
                showNotification('Timer paused', 'info');
            } else {
                timerPaused = false;
                document.getElementById('pause-timer-btn').innerHTML = '<i class="fas fa-pause mr-2"></i>Pause';
                timerInterval = setInterval(() => {
                    timerSeconds++;
                    updateTimerDisplay();
                }, 1000);
                showNotification('Timer resumed', 'success');
            }
        }

        function stopTimer() {
            if (confirm('Stop timer and save entry?')) {
                clearInterval(timerInterval);
                
                const project = document.getElementById('timer-project-select').value;
                const notes = document.getElementById('timer-notes').value || 'No description';
                const duration = timerSeconds;
                
                // Save entry
                const entry = {
                    id: Date.now(),
                    project: project,
                    notes: notes,
                    duration: duration,
                    date: new Date().toISOString()
                };
                
                timeEntries.unshift(entry);
                localStorage.setItem('timeEntries', JSON.stringify(timeEntries));
                
                // Reset timer
                timerSeconds = 0;
                timerRunning = false;
                timerPaused = false;
                updateTimerDisplay();
                document.getElementById('timer-display').textContent = '00:00:00';
                document.getElementById('current-project-name').textContent = 'No active timer';
                document.getElementById('timer-notes').value = '';
                
                document.getElementById('start-timer-btn').disabled = false;
                document.getElementById('pause-timer-btn').disabled = true;
                document.getElementById('stop-timer-btn').disabled = true;
                document.getElementById('pause-timer-btn').innerHTML = '<i class="fas fa-pause mr-2"></i>Pause';
                
                updateTimeEntries();
                updateTimeSummary();
                showNotification('Time entry saved! ✅', 'success');
            }
        }

        function updateTimerDisplay() {
            const hours = Math.floor(timerSeconds / 3600);
            const minutes = Math.floor((timerSeconds % 3600) / 60);
            const seconds = timerSeconds % 60;
            
            document.getElementById('timer-display').textContent = 
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function updateTimeEntries() {
            const tbody = document.getElementById('time-entries-list');
            
            if (timeEntries.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                            <i class="fas fa-clock text-4xl mb-2 opacity-20"></i>
                            <p>No time entries yet. Start tracking your time!</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = timeEntries.slice(0, 10).map(entry => {
                const date = new Date(entry.date);
                const hours = (entry.duration / 3600).toFixed(2);
                
                return `
                    <tr class="hover:bg-gray-50">
                        <td class="px-4 py-3">
                            <span class="font-medium text-gray-900">${entry.project}</span>
                        </td>
                        <td class="px-4 py-3 text-gray-600">${entry.notes}</td>
                        <td class="px-4 py-3 text-gray-600">${date.toLocaleDateString()}</td>
                        <td class="px-4 py-3">
                            <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm font-medium">${hours}h</span>
                        </td>
                        <td class="px-4 py-3">
                            <button onclick="deleteTimeEntry(${entry.id})" class="text-red-600 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function deleteTimeEntry(id) {
            if (confirm('Delete this time entry?')) {
                timeEntries = timeEntries.filter(e => e.id !== id);
                localStorage.setItem('timeEntries', JSON.stringify(timeEntries));
                updateTimeEntries();
                updateTimeSummary();
                showNotification('Entry deleted', 'success');
            }
        }

        function updateTimeSummary() {
            const now = new Date();
            const today = now.toDateString();
            
            let todaySeconds = 0;
            let weekSeconds = 0;
            let monthSeconds = 0;
            
            timeEntries.forEach(entry => {
                const entryDate = new Date(entry.date);
                
                if (entryDate.toDateString() === today) {
                    todaySeconds += entry.duration;
                }
                
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                if (entryDate >= weekAgo) {
                    weekSeconds += entry.duration;
                }
                
                if (entryDate.getMonth() === now.getMonth() && entryDate.getFullYear() === now.getFullYear()) {
                    monthSeconds += entry.duration;
                }
            });
            
            document.getElementById('today-hours').textContent = (todaySeconds / 3600).toFixed(1) + 'h';
            document.getElementById('week-hours').textContent = (weekSeconds / 3600).toFixed(1) + 'h';
            document.getElementById('month-hours').textContent = (monthSeconds / 3600).toFixed(1) + 'h';
            
            const hourlyRate = 50; // Default rate
            const totalEarnings = (monthSeconds / 3600) * hourlyRate;
            document.getElementById('total-earnings').textContent = '$' + totalEarnings.toFixed(0);
        }

        // ========================================
        // CALENDAR FUNCTIONS
        // ========================================
        let currentCalendarDate = new Date();
        let calendarEvents = JSON.parse(localStorage.getItem('calendarEvents') || '[]');

        function renderCalendar() {
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            
            document.getElementById('calendar-month-year').textContent = `${monthNames[month]} ${year}`;
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            const calendarDays = document.getElementById('calendar-days');
            calendarDays.innerHTML = '';
            
            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                calendarDays.innerHTML += '<div class="p-2"></div>';
            }
            
            // Days of the month
            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = day === today.getDate() && month === today.getMonth() && year === today.getFullYear();
                const hasEvent = calendarEvents.some(e => {
                    const eventDate = new Date(e.date);
                    return eventDate.getDate() === day && eventDate.getMonth() === month && eventDate.getFullYear() === year;
                });
                
                const dayClass = isToday ? 'bg-blue-600 text-white' : 'hover:bg-gray-100';
                const eventDot = hasEvent ? '<div class="w-1 h-1 bg-blue-600 rounded-full mx-auto mt-1"></div>' : '';
                
                calendarDays.innerHTML += `
                    <div class="p-2 text-center rounded-lg cursor-pointer ${dayClass} transition-colors" onclick="selectCalendarDay(${year}, ${month}, ${day})">
                        <div>${day}</div>
                        ${eventDot}
                    </div>
                `;
            }
        }

        function previousMonth() {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
            renderCalendar();
        }

        function selectCalendarDay(year, month, day) {
            showNotification(`Selected: ${month + 1}/${day}/${year}`, 'info');
        }

        function addEvent(type) {
            const isDeadline = type === 'deadline';
            const isMeeting = type === 'meeting';
            
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 20px;';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-bold text-gray-900 flex items-center">
                            <i class="fas fa-${isDeadline ? 'calendar-check' : 'video'} text-${isDeadline ? 'red' : 'blue'}-600 mr-3"></i>
                            Add ${isDeadline ? 'Deadline' : 'Meeting'}
                        </h3>
                        <button onclick="this.closest('div[style*=\\'fixed\\']').remove()" class="text-gray-400 hover:text-gray-600 transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-5">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ${isDeadline ? 'Deadline' : 'Meeting'} Title
                            </label>
                            <input type="text" id="event-title" 
                                   placeholder="${isDeadline ? 'e.g., Project Submission' : 'e.g., Client Review Meeting'}" 
                                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fas fa-calendar mr-2 text-blue-600"></i>Select Date
                            </label>
                            <input type="date" id="event-date" 
                                   value="${new Date().toISOString().split('T')[0]}"
                                   min="${new Date().toISOString().split('T')[0]}"
                                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all cursor-pointer">
                        </div>
                        
                        ${isMeeting ? `
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-clock mr-2 text-green-600"></i>Start Time
                                </label>
                                <input type="time" id="event-start-time" 
                                       value="14:00"
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all cursor-pointer">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-clock mr-2 text-red-600"></i>End Time
                                </label>
                                <input type="time" id="event-end-time" 
                                       value="15:00"
                                       class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all cursor-pointer">
                            </div>
                        </div>
                        ` : ''}
                        
                        ${isDeadline ? `
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fas fa-exclamation-triangle mr-2 text-orange-600"></i>Priority
                            </label>
                            <select id="event-priority" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all cursor-pointer">
                                <option value="high">🔴 High Priority</option>
                                <option value="medium" selected>🟡 Medium Priority</option>
                                <option value="low">🟢 Low Priority</option>
                            </select>
                        </div>
                        ` : ''}
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fas fa-align-left mr-2 text-purple-600"></i>Description (Optional)
                            </label>
                            <textarea id="event-description" rows="3" 
                                      placeholder="Add notes or details..."
                                      class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none"></textarea>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 mt-8">
                        <button onclick="saveCalendarEvent('${type}')" 
                                class="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white py-3 rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg">
                            <i class="fas fa-save mr-2"></i>Save ${isDeadline ? 'Deadline' : 'Meeting'}
                        </button>
                        <button onclick="this.closest('div[style*=\\'fixed\\']').remove()" 
                                class="px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-semibold transition-all">
                            Cancel
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Focus on title input
            setTimeout(() => document.getElementById('event-title').focus(), 100);
        }
        
        function saveCalendarEvent(type) {
            const title = document.getElementById('event-title').value;
            const date = document.getElementById('event-date').value;
            const description = document.getElementById('event-description').value;
            
            if (!title || !date) {
                showNotification('Please fill in the title and date', 'error');
                return;
            }
            
            const event = {
                id: Date.now(),
                type,
                title,
                date,
                description
            };
            
            // Add meeting-specific fields
            if (type === 'meeting') {
                event.startTime = document.getElementById('event-start-time').value;
                event.endTime = document.getElementById('event-end-time').value;
            }
            
            // Add deadline-specific fields
            if (type === 'deadline') {
                event.priority = document.getElementById('event-priority').value;
            }
            
            calendarEvents.push(event);
            localStorage.setItem('calendarEvents', JSON.stringify(calendarEvents));
            
            // Close modal
            document.querySelectorAll('div[style*="fixed"]').forEach(el => el.remove());
            
            // Update UI
            renderCalendar();
            updateEventLists();
            
            showNotification(`${type === 'deadline' ? 'Deadline' : 'Meeting'} added successfully! 🎉`, 'success');
            showConfetti();
        }
        
        function updateEventLists() {
            // Update deadlines list
            const deadlinesList = document.getElementById('deadlines-list');
            const deadlines = calendarEvents.filter(e => e.type === 'deadline').slice(0, 5);
            
            if (deadlines.length === 0) {
                deadlinesList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-calendar-times text-3xl mb-2 opacity-20"></i>
                        <p>No upcoming deadlines</p>
                    </div>
                `;
            } else {
                deadlinesList.innerHTML = deadlines.map(d => {
                    const eventDate = new Date(d.date);
                    const today = new Date();
                    const daysLeft = Math.ceil((eventDate - today) / (1000 * 60 * 60 * 24));
                    const isUrgent = daysLeft <= 7;
                    const priorityColors = {
                        high: 'border-red-500 bg-red-50',
                        medium: 'border-yellow-500 bg-yellow-50',
                        low: 'border-green-500 bg-green-50'
                    };
                    const priorityTextColors = {
                        high: 'text-red-600',
                        medium: 'text-yellow-600',
                        low: 'text-green-600'
                    };
                    
                    return `
                        <div class="flex items-start p-3 ${priorityColors[d.priority || 'medium']} rounded-lg border-l-4">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-900">${d.title}</h4>
                                ${d.description ? `<p class="text-sm text-gray-600 mt-1">${d.description}</p>` : ''}
                                <p class="text-xs ${priorityTextColors[d.priority || 'medium']} mt-2 font-medium">
                                    <i class="fas fa-clock mr-1"></i>${eventDate.toLocaleDateString()} - ${daysLeft > 0 ? daysLeft + ' days left' : 'Due today!'}
                                    ${isUrgent ? ' ⚠️' : ''}
                                </p>
                            </div>
                            <button onclick="deleteEvent(${d.id})" class="text-gray-400 hover:text-red-600 transition-colors ml-2">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;
                }).join('');
            }
            
            // Update meetings list
            const meetingsList = document.getElementById('meetings-list');
            const meetings = calendarEvents.filter(e => e.type === 'meeting').slice(0, 5);
            
            if (meetings.length === 0) {
                meetingsList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-video-slash text-3xl mb-2 opacity-20"></i>
                        <p>No upcoming meetings</p>
                    </div>
                `;
            } else {
                meetingsList.innerHTML = meetings.map(m => {
                    const eventDate = new Date(m.date);
                    const monthNames = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
                    
                    return `
                        <div class="flex items-start p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                            <div class="w-14 h-14 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold mr-3 flex-shrink-0">
                                <div class="text-center">
                                    <div class="text-xs">${monthNames[eventDate.getMonth()]}</div>
                                    <div class="text-lg">${eventDate.getDate()}</div>
                                </div>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-900">${m.title}</h4>
                                ${m.description ? `<p class="text-sm text-gray-600 mt-1">${m.description}</p>` : ''}
                                <p class="text-xs text-blue-600 mt-2 font-medium">
                                    <i class="fas fa-clock mr-1"></i>${m.startTime || '14:00'} - ${m.endTime || '15:00'}
                                </p>
                            </div>
                            <button onclick="deleteEvent(${m.id})" class="text-gray-400 hover:text-red-600 transition-colors ml-2">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;
                }).join('');
            }
        }
        
        function deleteEvent(id) {
            if (confirm('Delete this event?')) {
                calendarEvents = calendarEvents.filter(e => e.id !== id);
                localStorage.setItem('calendarEvents', JSON.stringify(calendarEvents));
                renderCalendar();
                updateEventLists();
                showNotification('Event deleted', 'success');
            }
        }

        // ========================================
        // PROPOSALS FUNCTIONS
        // ========================================
        let proposals = JSON.parse(localStorage.getItem('proposals') || '[]');

        function createNewProposal() {
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <h3 class="text-2xl font-bold text-gray-900 mb-6">
                        <i class="fas fa-sparkles text-blue-600 mr-2"></i>Generate Proposal with AI
                    </h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Project Title</label>
                            <input type="text" id="proposal-title" placeholder="e.g., E-commerce Website Development" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Client Name</label>
                            <input type="text" id="proposal-client" placeholder="Client company or name" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Project Description</label>
                            <textarea id="proposal-description" rows="4" placeholder="Describe the project scope and requirements..." 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Budget ($)</label>
                                <input type="number" id="proposal-budget" placeholder="5000" 
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Timeline (days)</label>
                                <input type="number" id="proposal-timeline" placeholder="30" 
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex items-start">
                                <i class="fas fa-robot text-blue-600 text-xl mr-3 mt-1"></i>
                                <div>
                                    <h4 class="font-semibold text-blue-900 mb-1">AI Enhancement</h4>
                                    <p class="text-sm text-blue-700">AI will generate a professional proposal with project scope, deliverables, timeline, and terms & conditions.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 mt-6">
                        <button onclick="generateProposal()" class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition-all">
                            <i class="fas fa-magic mr-2"></i>Generate with AI
                        </button>
                        <button onclick="this.closest('div[style*=\\'fixed\\']').remove()" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function generateProposal() {
            const title = document.getElementById('proposal-title').value;
            const client = document.getElementById('proposal-client').value;
            const description = document.getElementById('proposal-description').value;
            const budget = document.getElementById('proposal-budget').value;
            const timeline = document.getElementById('proposal-timeline').value;
            
            if (!title || !client || !description) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            // Simulate AI generation
            showNotification('AI is generating your proposal... 🤖', 'info');
            
            setTimeout(() => {
                const proposal = {
                    id: Date.now(),
                    title,
                    client,
                    description,
                    budget,
                    timeline,
                    status: 'Draft',
                    createdDate: new Date().toISOString(),
                    aiGenerated: true
                };
                
                proposals.unshift(proposal);
                localStorage.setItem('proposals', JSON.stringify(proposals));
                
                document.querySelectorAll('div[style*="fixed"]').forEach(el => el.remove());
                updateProposalsList();
                showNotification('Proposal generated successfully! ✨', 'success');
                showConfetti();
            }, 2000);
        }

        function updateProposalsList() {
            const list = document.getElementById('proposals-list');
            
            if (proposals.length === 0) {
                list.innerHTML = `
                    <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center">
                        <i class="fas fa-file-contract text-4xl text-gray-300 mb-3"></i>
                        <p class="text-gray-500 mb-4">No proposals yet</p>
                        <button onclick="createNewProposal()" class="text-blue-600 hover:text-blue-700 font-semibold">
                            <i class="fas fa-plus mr-1"></i>Create Your First Proposal
                        </button>
                    </div>
                `;
                return;
            }
            
            list.innerHTML = proposals.map(p => `
                <div class="border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow">
                    <div class="flex items-start justify-between mb-3">
                        <h4 class="font-semibold text-gray-900">${p.title}</h4>
                        ${p.aiGenerated ? '<span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full"><i class="fas fa-robot mr-1"></i>AI</span>' : ''}
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Client: ${p.client}</p>
                    <div class="flex items-center justify-between text-sm">
                        <span class="text-gray-500">$${p.budget} • ${p.timeline} days</span>
                        <span class="px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs font-medium">${p.status}</span>
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button onclick="viewProposal(${p.id})" class="flex-1 text-blue-600 hover:bg-blue-50 py-2 rounded-lg transition-colors text-sm font-medium">
                            <i class="fas fa-eye mr-1"></i>View
                        </button>
                        <button onclick="downloadProposal(${p.id})" class="flex-1 text-green-600 hover:bg-green-50 py-2 rounded-lg transition-colors text-sm font-medium">
                            <i class="fas fa-download mr-1"></i>Download
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function useProposalTemplate() {
            showNotification('Template library coming soon! 📚', 'info');
        }

        function importProposal() {
            showNotification('Import feature coming soon! 📤', 'info');
        }

        function viewProposal(id) {
            const proposal = proposals.find(p => p.id === id);
            if (proposal) {
                showNotification(`Viewing: ${proposal.title}`, 'info');
            }
        }

        function downloadProposal(id) {
            const proposal = proposals.find(p => p.id === id);
            if (proposal) {
                const blob = new Blob([JSON.stringify(proposal, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${proposal.title.replace(/\s+/g, '-')}-proposal.json`;
                a.click();
                URL.revokeObjectURL(url);
                showNotification('Proposal downloaded! 📥', 'success');
            }
        }

        // ========================================
        // CONTRACTS FUNCTIONS
        // ========================================
        let contracts = JSON.parse(localStorage.getItem('contracts') || '[]');

        function createNewContract() {
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <h3 class="text-2xl font-bold text-gray-900 mb-6">
                        <i class="fas fa-robot text-green-600 mr-2"></i>Generate Contract with AI
                    </h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Contract Type</label>
                            <select id="contract-type" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="service">Service Agreement</option>
                                <option value="nda">Non-Disclosure Agreement</option>
                                <option value="freelance">Freelance Contract</option>
                                <option value="consulting">Consulting Agreement</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Client Name</label>
                            <input type="text" id="contract-client" placeholder="Client company or individual" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Project/Service Description</label>
                            <textarea id="contract-description" rows="3" placeholder="Describe the services to be provided..." 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Contract Value ($)</label>
                                <input type="number" id="contract-value" placeholder="10000" 
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Duration (months)</label>
                                <input type="number" id="contract-duration" placeholder="6" 
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <div class="flex items-start">
                                <i class="fas fa-shield-alt text-green-600 text-xl mr-3 mt-1"></i>
                                <div>
                                    <h4 class="font-semibold text-green-900 mb-1">Legal AI Assistant</h4>
                                    <p class="text-sm text-green-700">AI will generate a legally sound contract with proper terms, payment schedules, and termination clauses.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 mt-6">
                        <button onclick="generateContract()" class="flex-1 bg-gradient-to-r from-green-600 to-teal-600 text-white py-3 rounded-lg font-semibold hover:from-green-700 hover:to-teal-700 transition-all">
                            <i class="fas fa-gavel mr-2"></i>Generate Contract
                        </button>
                        <button onclick="this.closest('div[style*=\\'fixed\\']').remove()" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function generateContract() {
            const type = document.getElementById('contract-type').value;
            const client = document.getElementById('contract-client').value;
            const description = document.getElementById('contract-description').value;
            const value = document.getElementById('contract-value').value;
            const duration = document.getElementById('contract-duration').value;
            
            if (!client || !description) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            // Simulate AI generation
            showNotification('AI is generating your contract... ⚖️', 'info');
            
            setTimeout(() => {
                const contract = {
                    id: Date.now(),
                    type,
                    client,
                    description,
                    value,
                    duration,
                    status: 'Pending',
                    createdDate: new Date().toISOString(),
                    aiGenerated: true
                };
                
                contracts.unshift(contract);
                localStorage.setItem('contracts', JSON.stringify(contracts));
                
                document.querySelectorAll('div[style*="fixed"]').forEach(el => el.remove());
                updateContractsList();
                showNotification('Contract generated successfully! 📝', 'success');
                showConfetti();
            }, 2000);
        }

        function updateContractsList() {
            const list = document.getElementById('contracts-list');
            
            if (contracts.length === 0) {
                list.innerHTML = `
                    <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center">
                        <i class="fas fa-file-signature text-4xl text-gray-300 mb-3"></i>
                        <p class="text-gray-500 mb-4">No contracts yet</p>
                        <button onclick="createNewContract()" class="text-green-600 hover:text-green-700 font-semibold">
                            <i class="fas fa-plus mr-1"></i>Create Your First Contract
                        </button>
                    </div>
                `;
                return;
            }
            
            list.innerHTML = contracts.map(c => {
                const statusColors = {
                    'Pending': 'bg-yellow-100 text-yellow-700',
                    'Active': 'bg-green-100 text-green-700',
                    'Signed': 'bg-blue-100 text-blue-700',
                    'Expired': 'bg-red-100 text-red-700'
                };
                
                return `
                    <div class="border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <h4 class="font-semibold text-gray-900">${c.type.replace('-', ' ').toUpperCase()}</h4>
                                <p class="text-sm text-gray-600 mt-1">Client: ${c.client}</p>
                            </div>
                            <span class="px-2 py-1 ${statusColors[c.status]} rounded text-xs font-medium">${c.status}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">${c.description.substring(0, 100)}...</p>
                        <div class="flex items-center justify-between text-sm mb-4">
                            <span class="text-gray-500">$${c.value} • ${c.duration} months</span>
                            ${c.aiGenerated ? '<span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full"><i class="fas fa-robot mr-1"></i>AI</span>' : ''}
                        </div>
                        <div class="flex gap-2">
                            <button onclick="viewContract(${c.id})" class="flex-1 text-green-600 hover:bg-green-50 py-2 rounded-lg transition-colors text-sm font-medium">
                                <i class="fas fa-eye mr-1"></i>View
                            </button>
                            <button onclick="signContract(${c.id})" class="flex-1 text-blue-600 hover:bg-blue-50 py-2 rounded-lg transition-colors text-sm font-medium">
                                <i class="fas fa-pen-fancy mr-1"></i>Sign
                            </button>
                            <button onclick="downloadContract(${c.id})" class="flex-1 text-purple-600 hover:bg-purple-50 py-2 rounded-lg transition-colors text-sm font-medium">
                                <i class="fas fa-download mr-1"></i>PDF
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function useContractTemplate() {
            showNotification('Template library coming soon! 📚', 'info');
        }

        function importContract() {
            showNotification('Import feature coming soon! 📤', 'info');
        }

        function viewContract(id) {
            const contract = contracts.find(c => c.id === id);
            if (contract) {
                showNotification(`Viewing: ${contract.type} for ${contract.client}`, 'info');
            }
        }

        function signContract(id) {
            if (confirm('Sign this contract? This action cannot be undone.')) {
                const contract = contracts.find(c => c.id === id);
                if (contract) {
                    contract.status = 'Signed';
                    localStorage.setItem('contracts', JSON.stringify(contracts));
                    updateContractsList();
                    showNotification('Contract signed successfully! ✍️', 'success');
                    showConfetti();
                }
            }
        }

        function downloadContract(id) {
            const contract = contracts.find(c => c.id === id);
            if (contract) {
                const blob = new Blob([JSON.stringify(contract, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${contract.client.replace(/\s+/g, '-')}-contract.json`;
                a.click();
                URL.revokeObjectURL(url);
                showNotification('Contract downloaded! 📥', 'success');
            }
        }
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            // Core functionality
            initChart();
            animateCounters();
            animateProgressBars();
            makeActivityClickable();
            
            // Enhanced interactive features
            initializeSettings();
            initializeChat();
            initSearch();
            
            // Initialize new features
            updateTimeEntries();
            updateTimeSummary();
            renderCalendar();
            updateEventLists();
            updateProposalsList();
            updateContractsList();
            
            // Show welcome message
            setTimeout(() => {
                showSuccessAnimation(null, 'Welcome to FreelanceHub! 🎉');
            }, 1000);
            
            // Console success messages
            console.log('✅ FreelanceHub initialized successfully!');
            console.log('🎯 All interactive features are working');
            console.log('📱 Responsive design active');
            console.log('⚙️ Settings persistence enabled');
            console.log('💬 Chat functionality ready');
            console.log('🔍 Search functionality active');
            console.log('🌙 Dark/Light mode working');
            console.log('🔔 Notifications ready');
            console.log('⚡ Quick actions enabled');
            
            // Add ARIA labels dynamically
            document.querySelectorAll('button').forEach(btn => {
                if (!btn.getAttribute('aria-label')) {
                    btn.setAttribute('aria-label', btn.textContent.trim() || 'Button');
                }
            });
            
            // Initialize sub-action styling
            const subActions = document.querySelectorAll('.fab-sub-action');
            subActions.forEach(action => {
                action.style.transform = 'scale(0) translateY(20px)';
                action.style.opacity = '0';
                action.style.transition = 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
            });
            
            // Add click handlers to FAB sub-actions
            subActions.forEach(action => {
                action.addEventListener('click', (e) => {
                    const tooltip = action.getAttribute('data-tooltip');
                    showSuccessAnimation(action, `${tooltip} clicked!`);
                    
                    // Close FAB menu
                    fabMenu.classList.add('hidden');
                    fabIcon.style.transform = 'rotate(0deg)';
                    fabTooltip.textContent = 'Quick Actions';
                    fabOpen = false;
                });
            });
            
            // Show confetti on certain actions
            document.addEventListener('click', (e) => {
                if (e.target.closest('[data-tooltip="New Project"]') || 
                    e.target.textContent.includes('New Invoice') ||
                    e.target.textContent.includes('Save Changes')) {
                    setTimeout(showConfetti, 200);
                }
            });
        });
    </script>
</body>
</html>